$((function(){"use strict";QUnit.module("scrollspy plugin"),QUnit.test("should be defined on jquery object",(function(i){i.expect(1),i.ok($(document.body).scrollspy,"scrollspy method is defined")})),QUnit.module("scrollspy",{beforeEach:function(){$.fn.bootstrapScrollspy=$.fn.scrollspy.noConflict()},afterEach:function(){$.fn.scrollspy=$.fn.bootstrapScrollspy,delete $.fn.bootstrapScrollspy,$("#qunit-fixture").html("")}}),QUnit.test("should provide no conflict",(function(i){i.expect(1),i.strictEqual(typeof $.fn.scrollspy,"undefined","scrollspy was set back to undefined (org value)")})),QUnit.test("should throw explicit error on undefined method",(function(i){i.expect(1);var t=$("<div/>").appendTo("#qunit-fixture");t.bootstrapScrollspy();try{t.bootstrapScrollspy("noMethod")}catch(e){i.strictEqual(e.message,'No method named "noMethod"')}})),QUnit.test("should return jquery collection containing the element",(function(i){i.expect(2);var t=$("<div/>").appendTo("#qunit-fixture"),e=t.bootstrapScrollspy();i.ok(e instanceof $,"returns jquery collection"),i.strictEqual(e[0],t[0],"collection contains element")})),QUnit.test('should only switch "active" class on current target',(function(i){i.expect(1);var t=i.async(),e='<div id="root" class="active"><div class="topbar"><div class="topbar-inner"><div class="container" id="ss-target"><ul class="nav"><li class="nav-item"><a href="#masthead">Overview</a></li><li class="nav-item"><a href="#detail">Detail</a></li></ul></div></div></div><div id="scrollspy-example" style="height: 100px; overflow: auto;"><div style="height: 200px;"><h4 id="masthead">Overview</h4><p style="height: 200px">Ad leggings keytar, brunch id art party dolor labore.</p></div><div style="height: 200px;"><h4 id="detail">Detail</h4><p style="height: 200px">Veniam marfa mustache skateboard, adipisicing fugiat velit pitchfork beard.</p></div></div></div>',a=$(e).appendTo("#qunit-fixture"),s=a.show().find("#scrollspy-example").bootstrapScrollspy({target:"#ss-target"});s.one("scroll",(function(){i.ok(a.hasClass("active"),'"active" class still on root node'),t()})),s.scrollTop(350)})),QUnit.test('should only switch "active" class on current target specified w element',(function(i){i.expect(1);var t=i.async(),e='<div id="root" class="active"><div class="topbar"><div class="topbar-inner"><div class="container" id="ss-target"><ul class="nav"><li class="nav-item"><a href="#masthead">Overview</a></li><li class="nav-item"><a href="#detail">Detail</a></li></ul></div></div></div><div id="scrollspy-example" style="height: 100px; overflow: auto;"><div style="height: 200px;"><h4 id="masthead">Overview</h4><p style="height: 200px">Ad leggings keytar, brunch id art party dolor labore.</p></div><div style="height: 200px;"><h4 id="detail">Detail</h4><p style="height: 200px">Veniam marfa mustache skateboard, adipisicing fugiat velit pitchfork beard.</p></div></div></div>',a=$(e).appendTo("#qunit-fixture"),s=a.show().find("#scrollspy-example").bootstrapScrollspy({target:document.getElementById("ss-target")});s.one("scroll",(function(){i.ok(a.hasClass("active"),'"active" class still on root node'),t()})),s.scrollTop(350)})),QUnit.test('should only switch "active" class on current target specified w jQuery element',(function(i){i.expect(1);var t=i.async(),e='<div id="root" class="active"><div class="topbar"><div class="topbar-inner"><div class="container" id="ss-target"><ul class="nav"><li class="nav-item"><a href="#masthead">Overview</a></li><li class="nav-item"><a href="#detail">Detail</a></li></ul></div></div></div><div id="scrollspy-example" style="height: 100px; overflow: auto;"><div style="height: 200px;"><h4 id="masthead">Overview</h4><p style="height: 200px">Ad leggings keytar, brunch id art party dolor labore.</p></div><div style="height: 200px;"><h4 id="detail">Detail</h4><p style="height: 200px">Veniam marfa mustache skateboard, adipisicing fugiat velit pitchfork beard.</p></div></div></div>',a=$(e).appendTo("#qunit-fixture"),s=a.show().find("#scrollspy-example").bootstrapScrollspy({target:$("#ss-target")});s.one("scroll",(function(){i.ok(a.hasClass("active"),'"active" class still on root node'),t()})),s.scrollTop(350)})),QUnit.test('should only switch "active" class on current target specified without ID',(function(i){i.expect(2);var t=i.async(),e='<div id="root" class="active"><div class="topbar"><div class="topbar-inner"><div class="container"><ul class="nav"><li class="nav-item"><a href="#masthead">Overview</a></li><li class="nav-item"><a href="#detail">Detail</a></li></ul></div></div></div><div id="scrollspy-example" style="height: 100px; overflow: auto;"><div style="height: 200px;"><h4 id="masthead">Overview</h4><p style="height: 200px">Ad leggings keytar, brunch id art party dolor labore.</p></div><div style="height: 200px;"><h4 id="detail">Detail</h4><p style="height: 200px">Veniam marfa mustache skateboard, adipisicing fugiat velit pitchfork beard.</p></div></div></div>',a=$(e).appendTo("#qunit-fixture"),s=a.show().find("#scrollspy-example").bootstrapScrollspy({target:$(".container")});i.ok($(".container").attr("id").length>0,"`target` has an ID attribute"),s.one("scroll",(function(){i.ok(a.hasClass("active"),'"active" class still on root node'),t()})),s.scrollTop(350)})),QUnit.test("should correctly select middle navigation option when large offset is used",(function(i){i.expect(3);var t=i.async(),e='<div id="header" style="height: 500px;"></div><nav id="navigation" class="navbar"><ul class="navbar-nav"><li class="nav-item active"><a class="nav-link" id="one-link" href="#one">One</a></li><li class="nav-item"><a class="nav-link" id="two-link" href="#two">Two</a></li><li class="nav-item"><a class="nav-link" id="three-link" href="#three">Three</a></li></ul></nav><div id="content" style="height: 200px; overflow-y: auto;"><div id="one" style="height: 500px;"></div><div id="two" style="height: 300px;"></div><div id="three" style="height: 10px;"></div></div>',a=$(e).appendTo("#qunit-fixture"),s=a.show().filter("#content");s.bootstrapScrollspy({target:"#navigation",offset:s.position().top}),s.one("scroll",(function(){i.ok(!a.find("#one-link").hasClass("active"),'"active" class removed from first section'),i.ok(a.find("#two-link").hasClass("active"),'"active" class on middle section'),i.ok(!a.find("#three-link").hasClass("active"),'"active" class not on last section'),t()})),s.scrollTop(550)})),QUnit.test("should add the active class to the correct element",(function(i){i.expect(2);var t='<nav class="navbar"><ul class="nav"><li class="nav-item"><a class="nav-link" id="a-1" href="#div-1">div 1</a></li><li class="nav-item"><a class="nav-link" id="a-2" href="#div-2">div 2</a></li></ul></nav>',e='<div class="content" style="overflow: auto; height: 50px"><div id="div-1" style="height: 100px; padding: 0; margin: 0">div 1</div><div id="div-2" style="height: 200px; padding: 0; margin: 0">div 2</div></div>';$(t).appendTo("#qunit-fixture");var a=$(e).appendTo("#qunit-fixture").bootstrapScrollspy({offset:0,target:".navbar"}),s=i.async(),n=function(t,e){var s=$.Deferred(),n=5,l=Math.ceil(a.scrollTop()+$(e).position().top)+n;return a.one("scroll",(function(){i.ok($(t).hasClass("active"),"target:"+e+", element"+t),s.resolve()})),a.scrollTop(l),s.promise()};$.when(n("#a-1","#div-1")).then((function(){return n("#a-2","#div-2")})).then((function(){s()}))})),QUnit.test("should add the active class to the correct element (nav markup)",(function(i){i.expect(2);var t='<nav class="navbar"><nav class="nav"><a class="nav-link" id="a-1" href="#div-1">div 1</a><a class="nav-link" id="a-2" href="#div-2">div 2</a></nav></nav>',e='<div class="content" style="overflow: auto; height: 50px"><div id="div-1" style="height: 100px; padding: 0; margin: 0">div 1</div><div id="div-2" style="height: 200px; padding: 0; margin: 0">div 2</div></div>';$(t).appendTo("#qunit-fixture");var a=$(e).appendTo("#qunit-fixture").bootstrapScrollspy({offset:0,target:".navbar"}),s=i.async(),n=function(t,e){var s=$.Deferred(),n=5,l=Math.ceil(a.scrollTop()+$(e).position().top)+n;return a.one("scroll",(function(){i.ok($(t).hasClass("active"),"target:"+e+", element"+t),s.resolve()})),a.scrollTop(l),s.promise()};$.when(n("#a-1","#div-1")).then((function(){return n("#a-2","#div-2")})).then((function(){s()}))})),QUnit.test("should add the active class to the correct element (list-group markup)",(function(i){i.expect(2);var t='<nav class="navbar"><div class="list-group"><a class="list-group-item" id="a-1" href="#div-1">div 1</a><a class="list-group-item" id="a-2" href="#div-2">div 2</a></div></nav>',e='<div class="content" style="overflow: auto; height: 50px"><div id="div-1" style="height: 100px; padding: 0; margin: 0">div 1</div><div id="div-2" style="height: 200px; padding: 0; margin: 0">div 2</div></div>';$(t).appendTo("#qunit-fixture");var a=$(e).appendTo("#qunit-fixture").bootstrapScrollspy({offset:0,target:".navbar"}),s=i.async(),n=function(t,e){var s=$.Deferred(),n=5,l=Math.ceil(a.scrollTop()+$(e).position().top)+n;return a.one("scroll",(function(){i.ok($(t).hasClass("active"),"target:"+e+", element"+t),s.resolve()})),a.scrollTop(l),s.promise()};$.when(n("#a-1","#div-1")).then((function(){return n("#a-2","#div-2")})).then((function(){s()}))})),QUnit.test("should add the active class correctly when there are nested elements at 0 scroll offset",(function(i){i.expect(6);var t=0,e=i.async(),a='<nav id="navigation" class="navbar"><ul class="nav"><li class="nav-item"><a id="a-1" class="nav-link" href="#div-1">div 1</a><ul class="nav"><li class="nav-item"><a id="a-2" class="nav-link" href="#div-2">div 2</a></li></ul></li></ul></nav>',s='<div class="content" style="position: absolute; top: 0px; overflow: auto; height: 50px"><div id="div-1" style="padding: 0; margin: 0"><div id="div-2" style="height: 200px; padding: 0; margin: 0">div 2</div></div></div>';$(a).appendTo("#qunit-fixture");var n=$(s).appendTo("#qunit-fixture").bootstrapScrollspy({offset:0,target:"#navigation"});function l(){if(++t>3)return e();n.one("scroll",(function(){i.ok($("#a-1").hasClass("active"),'nav item for outer element has "active" class'),i.ok($("#a-2").hasClass("active"),'nav item for inner element has "active" class'),l()})),n.scrollTop(n.scrollTop()+10)}l()})),QUnit.test("should add the active class correctly when there are nested elements (nav markup)",(function(i){i.expect(6);var t=0,e=i.async(),a='<nav id="navigation" class="navbar"><nav class="nav"><a id="a-1" class="nav-link" href="#div-1">div 1</a><nav class="nav"><a id="a-2" class="nav-link" href="#div-2">div 2</a></nav></nav></nav>',s='<div class="content" style="position: absolute; top: 0px; overflow: auto; height: 50px"><div id="div-1" style="padding: 0; margin: 0"><div id="div-2" style="height: 200px; padding: 0; margin: 0">div 2</div></div></div>';$(a).appendTo("#qunit-fixture");var n=$(s).appendTo("#qunit-fixture").bootstrapScrollspy({offset:0,target:"#navigation"});function l(){if(++t>3)return e();n.one("scroll",(function(){i.ok($("#a-1").hasClass("active"),'nav item for outer element has "active" class'),i.ok($("#a-2").hasClass("active"),'nav item for inner element has "active" class'),l()})),n.scrollTop(n.scrollTop()+10)}l()})),QUnit.test("should add the active class correctly when there are nested elements (nav nav-item markup)",(function(i){i.expect(6);var t=0,e=i.async(),a='<nav id="navigation" class="navbar"><ul class="nav"><li class="nav-item"><a id="a-1" class="nav-link" href="#div-1">div 1</a></li><ul class="nav"><li class="nav-item"><a id="a-2" class="nav-link" href="#div-2">div 2</a></li></ul></ul></nav>',s='<div class="content" style="position: absolute; top: 0px; overflow: auto; height: 50px"><div id="div-1" style="padding: 0; margin: 0"><div id="div-2" style="height: 200px; padding: 0; margin: 0">div 2</div></div></div>';$(a).appendTo("#qunit-fixture");var n=$(s).appendTo("#qunit-fixture").bootstrapScrollspy({offset:0,target:"#navigation"});function l(){if(++t>3)return e();n.one("scroll",(function(){i.ok($("#a-1").hasClass("active"),'nav item for outer element has "active" class'),i.ok($("#a-2").hasClass("active"),'nav item for inner element has "active" class'),l()})),n.scrollTop(n.scrollTop()+10)}l()})),QUnit.test("should add the active class correctly when there are nested elements (list-group markup)",(function(i){i.expect(6);var t=0,e=i.async(),a='<nav id="navigation" class="navbar"><div class="list-group"><a id="a-1" class="list-group-item" href="#div-1">div 1</a><div class="list-group"><a id="a-2" class="list-group-item" href="#div-2">div 2</a></div></div></nav>',s='<div class="content" style="position: absolute; top: 0px; overflow: auto; height: 50px"><div id="div-1" style="padding: 0; margin: 0"><div id="div-2" style="height: 200px; padding: 0; margin: 0">div 2</div></div></div>';$(a).appendTo("#qunit-fixture");var n=$(s).appendTo("#qunit-fixture").bootstrapScrollspy({offset:0,target:"#navigation"});function l(){if(++t>3)return e();n.one("scroll",(function(){i.ok($("#a-1").hasClass("active"),'nav item for outer element has "active" class'),i.ok($("#a-2").hasClass("active"),'nav item for inner element has "active" class'),l()})),n.scrollTop(n.scrollTop()+10)}l()})),QUnit.test("should clear selection if above the first section",(function(i){i.expect(3);var t=i.async(),e='<div id="header" style="height: 500px;"></div><nav id="navigation" class="navbar"><ul class="navbar-nav"><li class="nav-item"><a id="one-link"   class="nav-link active" href="#one">One</a></li><li class="nav-item"><a id="two-link"   class="nav-link" href="#two">Two</a></li><li class="nav-item"><a id="three-link" class="nav-link" href="#three">Three</a></li></ul></nav>';$(e).appendTo("#qunit-fixture");var a='<div id="content" style="height: 200px; overflow-y: auto;"><div id="spacer" style="height: 100px;"></div><div id="one" style="height: 100px;"></div><div id="two" style="height: 100px;"></div><div id="three" style="height: 100px;"></div><div id="spacer" style="height: 100px;"></div></div>',s=$(a).appendTo("#qunit-fixture");s.bootstrapScrollspy({target:"#navigation",offset:s.position().top}).one("scroll",(function(){i.strictEqual($(".active").length,1,'"active" class on only one element present'),i.strictEqual($(".active").is("#two-link"),!0,'"active" class on second section'),s.one("scroll",(function(){i.strictEqual($(".active").length,0,"selection cleared"),t()})).scrollTop(0)})).scrollTop(201)})),QUnit.test("should NOT clear selection if above the first section and first section is at the top",(function(i){i.expect(4);var t=i.async(),e='<div id="header" style="height: 500px;"></div><nav id="navigation" class="navbar"><ul class="navbar-nav"><li class="nav-item"><a id="one-link"   class="nav-link active" href="#one">One</a></li><li class="nav-item"><a id="two-link"   class="nav-link" href="#two">Two</a></li><li class="nav-item"><a id="three-link" class="nav-link" href="#three">Three</a></li></ul></nav>';$(e).appendTo("#qunit-fixture");var a=-10,s=101,n='<div id="content" style="height: 200px; overflow-y: auto;"><div id="one" style="height: 100px;"></div><div id="two" style="height: 100px;"></div><div id="three" style="height: 100px;"></div><div id="spacer" style="height: 100px;"></div></div>',l=$(n).appendTo("#qunit-fixture");l.bootstrapScrollspy({target:"#navigation",offset:l.position().top}).one("scroll",(function(){i.strictEqual($(".active").length,1,'"active" class on only one element present'),i.strictEqual($(".active").is("#two-link"),!0,'"active" class on second section'),l.one("scroll",(function(){i.strictEqual($(".active").length,1,'"active" class on only one element present'),i.strictEqual($(".active").is("#one-link"),!0,'"active" class on first section'),t()})).scrollTop(a)})).scrollTop(s)})),QUnit.test("should correctly select navigation element on backward scrolling when each target section height is 100%",(function(i){i.expect(5);var t='<nav class="navbar"><ul class="nav"><li class="nav-item"><a id="li-100-1" class="nav-link" href="#div-100-1">div 1</a></li><li class="nav-item"><a id="li-100-2" class="nav-link" href="#div-100-2">div 2</a></li><li class="nav-item"><a id="li-100-3" class="nav-link" href="#div-100-3">div 3</a></li><li class="nav-item"><a id="li-100-4" class="nav-link" href="#div-100-4">div 4</a></li><li class="nav-item"><a id="li-100-5" class="nav-link" href="#div-100-5">div 5</a></li></ul></nav>',e='<div class="content" style="position: relative; overflow: auto; height: 100px"><div id="div-100-1" style="position: relative; height: 100%; padding: 0; margin: 0">div 1</div><div id="div-100-2" style="position: relative; height: 100%; padding: 0; margin: 0">div 2</div><div id="div-100-3" style="position: relative; height: 100%; padding: 0; margin: 0">div 3</div><div id="div-100-4" style="position: relative; height: 100%; padding: 0; margin: 0">div 4</div><div id="div-100-5" style="position: relative; height: 100%; padding: 0; margin: 0">div 5</div></div>';$(t).appendTo("#qunit-fixture");var a=$(e).appendTo("#qunit-fixture").bootstrapScrollspy({offset:0,target:".navbar"}),s=function(t,e){var s=$.Deferred(),n=5,l=Math.ceil(a.scrollTop()+$(e).position().top)+n;return a.one("scroll",(function(){i.ok($(t).hasClass("active"),"target:"+e+", element: "+t),s.resolve()})),a.scrollTop(l),s.promise()},n=i.async();$.when(s("#li-100-5","#div-100-5")).then((function(){return s("#li-100-4","#div-100-4")})).then((function(){return s("#li-100-3","#div-100-3")})).then((function(){return s("#li-100-2","#div-100-2")})).then((function(){return s("#li-100-1","#div-100-1")})).then((function(){n()}))})),QUnit.test("should allow passed in option offset method: offset",(function(i){i.expect(4);var t=function(t){var e=$('<nav class="navbar"'+("data"===t?' id="navbar-offset-method-menu"':"")+'><ul class="nav"><li class="nav-item"><a id="li-'+t+'m-1" class="nav-link" href="#div-'+t+'m-1">div 1</a></li><li class="nav-item"><a id="li-'+t+'m-2" class="nav-link" href="#div-'+t+'m-2">div 2</a></li><li class="nav-item"><a id="li-'+t+'m-3" class="nav-link" href="#div-'+t+'m-3">div 3</a></li></ul></nav>'),a=$('<div class="content"'+("data"===t?' data-spy="scroll" data-target="#navbar-offset-method-menu" data-offset="0" data-method="offset"':"")+' style="position: relative; overflow: auto; height: 100px"><div id="div-'+t+'m-1" style="position: relative; height: 200px; padding: 0; margin: 0">div 1</div><div id="div-'+t+'m-2" style="position: relative; height: 150px; padding: 0; margin: 0">div 2</div><div id="div-'+t+'m-3" style="position: relative; height: 250px; padding: 0; margin: 0">div 3</div></div>');e.appendTo("#qunit-fixture"),a.appendTo("#qunit-fixture"),"js"===t?a.bootstrapScrollspy({target:".navbar",offset:0,method:"offset"}):"data"===t&&$(window).trigger("load");var s=$("#div-"+t+"m-2"),n=a.data("bs.scrollspy");i.ok(n._offsets[1]===s.offset().top,"offset method with "+t+" option"),i.ok(n._offsets[1]!==s.position().top,"position method with "+t+" option"),e.remove(),a.remove()};t("js"),t("data")})),QUnit.test("should allow passed in option offset method: position",(function(i){i.expect(4);var t=function(t){var e=$('<nav class="navbar"'+("data"===t?' id="navbar-offset-method-menu"':"")+'><ul class="nav"><li class="nav-item"><a class="nav-link" id="li-'+t+'m-1" href="#div-'+t+'m-1">div 1</a></li><li class="nav-item"><a class="nav-link" id="li-'+t+'m-2" href="#div-'+t+'m-2">div 2</a></li><li class="nav-item"><a class="nav-link" id="li-'+t+'m-3" href="#div-'+t+'m-3">div 3</a></li></ul></nav>'),a=$('<div class="content"'+("data"===t?' data-spy="scroll" data-target="#navbar-offset-method-menu" data-offset="0" data-method="position"':"")+' style="position: relative; overflow: auto; height: 100px"><div id="div-'+t+'m-1" style="position: relative; height: 200px; padding: 0; margin: 0">div 1</div><div id="div-'+t+'m-2" style="position: relative; height: 150px; padding: 0; margin: 0">div 2</div><div id="div-'+t+'m-3" style="position: relative; height: 250px; padding: 0; margin: 0">div 3</div></div>');e.appendTo("#qunit-fixture"),a.appendTo("#qunit-fixture"),"js"===t?a.bootstrapScrollspy({target:".navbar",offset:0,method:"position"}):"data"===t&&$(window).trigger("load");var s=$("#div-"+t+"m-2"),n=a.data("bs.scrollspy");i.ok(n._offsets[1]!==s.offset().top,"offset method with "+t+" option"),i.ok(n._offsets[1]===s.position().top,"position method with "+t+" option"),e.remove(),a.remove()};t("js"),t("data")})),QUnit.test("should raise exception to avoid xss on target",(function(i){i.expect(1),i.throws((function(){var i='<div id="root" class="active"><div class="topbar"><div class="topbar-inner"><div class="container" id="ss-target"><ul class="nav"><li class="nav-item"><a href="#masthead">Overview</a></li><li class="nav-item"><a href="#detail">Detail</a></li></ul></div></div></div><div id="scrollspy-example" style="height: 100px; overflow: auto;"><div style="height: 200px;"><h4 id="masthead">Overview</h4><p style="height: 200px">Ad leggings keytar, brunch id art party dolor labore.</p></div><div style="height: 200px;"><h4 id="detail">Detail</h4><p style="height: 200px">Veniam marfa mustache skateboard, adipisicing fugiat velit pitchfork beard.</p></div></div></div>';$(i).appendTo(document.body),$("#ss-target").bootstrapScrollspy({target:"<img src=1 onerror='alert(0)'>"})}),/SyntaxError/)}))}));