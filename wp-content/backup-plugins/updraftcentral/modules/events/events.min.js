function UpdraftCentral_Events_Management(){var a=this,s=jQuery,e=(new UpdraftCentral_Collection,UpdraftCentral.get_debug_level(),!1);this.container_visible_state={search:!0,sites:!0},this.update_listener_on_mobile_view=function(){e||(UpdraftCentral.subscribe_to_node_changes(s("table#updraftcentral_events_table > tbody"),function(e,t){for(var a=[],n=0;n<e.length;n++){var r=e[n];r.addedNodes.length&&a.push(r.addedNodes[0].className)}-1!==a.indexOf("child")&&s("a.updraftcentral_events_result_view").off("click").on("click",function(){var e=atob(s(this).attr("data-event_result_data"));UpdraftCentral_Library.dialog.alert("<h2>"+udclion.events.events_result_data+'</h2><p><div class="updraftcentral_events_result_data">'+e+"</div></p>")})},"events-table"),e=!0)},s("#updraftcentral_dashboard_existingsites").on("updraftcentral_dashboard_mode_set",function(e,t){var r;if(t&&t.hasOwnProperty("new_mode")&&"events"===t.new_mode)return a.container_visible_state.search=s("#updraftcentral_sites_search_area").is(":visible"),a.container_visible_state.sites=s("#updraftcentral_dashboard_existingsites_container").is(":visible"),s("#updraftcentral_sites_search_area").hide(),s("#updraftcentral_dashboard_existingsites_container").hide(),void(s.fn.DataTable.fnIsDataTable(s("#updraftcentral_events_table").get(0))||s("#updraftcentral_events_table").on("draw.dt",function(){s("a.updraftcentral_events_result_view").on("click",function(){var e=atob(s(this).attr("data-event_result_data"));UpdraftCentral_Library.dialog.alert("<h2>"+udclion.events.events_result_data+'</h2><p><div class="updraftcentral_events_result_data">'+e+"</div></p>")}),a.update_listener_on_mobile_view()}).on("preXhr.dt",function(e,t,a){0===(r=s(this).find(".updraftcentral_spinner")).length&&s(this).prepend('<div class="updraftcentral_spinner"></div>')}).on("xhr.dt",function(e,t,a,n){(r=s(this).find(".updraftcentral_spinner")).length&&r.remove()}).DataTable({autoWidth:!0,bStateSave:!1,lengthMenu:[[10,25,50,100],[10,25,50,100]],responsive:!0,processing:!1,serverSide:!0,infoCallback:function(e,t,a,n,r,s){t=0===r?0:t;t=sprintf(udclion.events.showing,t,a,r);return r!==n&&(t+=" ("+sprintf(udclion.events.filtered_from,n)+")"),t},ajax:{url:udclion.ajaxurl,type:"POST",data:function(e){return dtp_data=s.extend({},e),e.action="updraftcentral_dashboard_ajax",e.subaction="events",e.component="dashboard",e.nonce=udclion.updraftcentral_dashboard_nonce,e.data=dtp_data,e},dataFilter:function(t){try{var e=JSON.parse(t);return e.recordsTotal=parseInt(e.recordsTotal),e.recordsFiltered=parseInt(e.recordsTotal),JSON.stringify(e)}catch(e){return t}}},columns:[{data:"event_name"},{data:"description"},{data:"event_status"},{data:"time"},{data:"event_result_data"}]}));t&&t.hasOwnProperty("previous_mode")&&t.hasOwnProperty("new_mode")&&"events"===t.previous_mode&&"events"!==t.new_mode&&"notices"!==t.new_mode&&(a.container_visible_state.search&&s("#updraftcentral_sites_search_area").show(),a.container_visible_state.sites&&s("#updraftcentral_dashboard_existingsites_container").show()),UpdraftCentral.register_event_handler("click","button#uc-btn-refresh-list",function(){var t=s("#updraftcentral_events_table").DataTable();t.search(""),t.page.len(10),t.ajax.reload(function(e){t.columns.adjust().draw()})})})}jQuery(function(e){new UpdraftCentral_Events_Management});