function UpdraftCentral_Paginator(e,t,r){var a=this,n=t.current_page,o=t.total_pages,i=r;function s(r){a.element.find(".page").each(function(e,t){jQuery(this).removeClass("page_active"),jQuery(this).attr("aria-selected",!1),jQuery(this).data("page")===r&&(jQuery(this).addClass("page_active"),jQuery(this).attr("aria-selected",!0))}),a.element.find(".page_prev").removeClass("disabled"),a.element.find(".page_next").removeClass("disabled"),1===r?a.element.find(".page_prev").addClass("disabled"):r===o&&a.element.find(".page_next").addClass("disabled"),a.element.trigger("page_change",n),jQuery.isFunction(i)&&i(n)}1<o&&(function(e){for(var t=[],r=1;r<=o;r++)t.push(r);a.element=jQuery(UpdraftCentral.template_replace("dashboard-paginator",{pages:t})),a.element.appendTo(e),a.element.on("click","a",function(e){e.preventDefault(),jQuery(this).hasClass("active")||(jQuery(this).hasClass("page_prev")?1<n&&s(--n):jQuery(this).hasClass("page_next")?n<o&&s(++n):jQuery(this).hasClass("page")&&(e=jQuery(this).data("page"),(e=e)!==n&&s(n=e)))})}(e),s(n)),this.page_change=function(e){i=e}}jQuery(function(e){(UpdraftCentral=UpdraftCentral()).init()}),function(e){"use strict";e.console=e.console||{};for(var t,r,a=e.console,n={},o=function(){},i="memory".split(","),s="assert,clear,count,debug,dir,dirxml,error,exception,group,groupCollapsed,groupEnd,info,log,markTimeline,profile,profiles,profileEnd,show,table,time,timeEnd,timeline,timelineEnd,timeStamp,trace,warn".split(",");t=i.pop();)a[t]||(a[t]=n);for(;r=s.pop();)"function"!=typeof a[r]&&(a[r]=o)}("undefined"==typeof window?this:window);var UpdraftCentral=function(){var l,f="undefined"!=typeof udclion&&udclion.hasOwnProperty("debug_level")?udclion.debug_level:0,e=0<f?5e3:1e4,t=670,g=(window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,jQuery),u=this,n=new UpdraftCentral_Collection;function s(e){return e.site_id==this}function o(e,t,r){var a=e.find(".updraft-sub-menu-arrow-left");a.is(":visible")?(a.hide(),e.find(".updraft-sub-menu-arrow-down").show(),t.appendTo(r).show()):(e.find(".updraft-sub-menu-arrow-down").hide(),a.show(),r.find(".updraft-sub-menu").appendTo(e).hide())}this.ajax_request_processing=!1,this.uc_action_triggered=!1,this.uc_action_data=[],this.event_trigger=new UpdraftCentral_Collection,this.uc_module,this.reloaded=!1,this.recorder=null,this.init=function(){UpdraftCentral.add_reload_listener(),UpdraftCentral.fill_content_area(),UpdraftCentral.init_recorder(),UpdraftCentral.init_keyboard_shortcuts(),UpdraftCentral.init_process_listener(),UpdraftCentral.init_tooltip(),UpdraftCentral.storage_purge(),UpdraftCentral.set_requested_mode(),UpdraftCentral.init_housekeeping()},this.log_event=function(e,t,r,a,n,o){var i=g.Deferred(),s=!1,o={site_id:e,event_type:t,event_name:-1===r.indexOf(t+".")?t+"."+r:r,event_data:JSON.stringify(n),event_status:a,event_result_data:JSON.stringify(o)};return UpdraftCentral.send_ajax("log_event",o,null,"via_mothership_encrypting",UpdraftCentral.$site_row,function(e,t,r){"ok"===t&&e.hasOwnProperty("message")&&"success"===e.message&&(i.resolve(),s=!0),s||i.reject(e)}),i.promise()},this.bulk_log_event=function(e){var a=g.Deferred(),n=!1;return UpdraftCentral.send_ajax("log_event",{bulk:1,data:e},null,"via_mothership_encrypting",UpdraftCentral.$site_row,function(e,t,r){"ok"===t&&e.hasOwnProperty("message")&&"success"===e.message&&(a.resolve(),n=!0),n||a.reject(e)}),a.promise()},this.add_reload_listener=function(){window.addEventListener("beforeunload",function(){console.log("")}),g(window).on("beforeunload",function(){UpdraftCentral.reloaded=!0})},this.fill_content_area=function(){var e=g("#updraftcentral_dashboard_wrapper");g("body").children(":not(script):not(style):not(link)").hide();var t,r=g("body > #wrapper");0===r.length&&0===(t=(r=g("<div/>",{id:"wrapper"}).prependTo(g("body"))).find("#content")).length&&(t=g("<div/>",{id:"content"}).appendTo(r)),g("body > #wrapper > #content")&&(0!==(t=g("body > #wrapper > #content")).length&&e.appendTo(t),t.is(":visible")||t.show(),r.is(":visible")||r.show()),g("body").addClass("updraftcentral-fill-view")},this.clear_editor_container=function(e){var t;null!==e&&e.new_mode===e.previous_mode||void 0!==(e=(t=g("#gutenberg_editor_container")).find("#editor"))&&e.length&&(e.is(":visible")||(void 0!==window._wpLoadBlockEditor&&delete window._wpLoadBlockEditor,"function"==typeof window.wp_data_unsubscribe&&window.wp_data_unsubscribe(),"undefined"!=typeof ReactDOM&&ReactDOM.hasOwnProperty("unmountComponentAtNode")&&ReactDOM.unmountComponentAtNode(e.get(0)),wp.element.unmountComponentAtNode(e.get(0)),e.remove(),t.remove()))},this.init_housekeeping=function(){g("#updraftcentral_dashboard_existingsites").on("updraftcentral_dashboard_mode_pre_set",function(){g("#updraftcentral_dashboard .more-option-container.show").each(function(){g(this).find("button").trigger("click")})}),g(".uc_site_alert_icon").length&&g(".uc_site_alert_icon").each(function(){g(this).tooltip({container:g("#updraftcentral_dashboard").get(0),trigger:"hover",placement:"top",boundary:"viewport"})}),g("#updraftcentral_dashboard_existingsites").on("updraftcentral_dashboard_mode_set_after",function(){UpdraftCentral.reset_site_selection()})},this.reset_site_selection=function(){var e=u.recorder.get_current_site();void 0!==e&&e&&(UpdraftCentral.$site_row.data("site_id")!=e.data("site_id")&&(UpdraftCentral.$site_row=e),e.hasClass("suspended")&&(u.recorder.reset_recorder(),g(".updraftcentral-search-area").show(),g("#updraftcentral_dashboard_existingsites").find(".ui-sortable-handle").show(),g("#updraft-central-content button.updraftcentral_action_choose_another_site").hide()))},this.cache_response=function(e,t,r,a){var n=g.Deferred(),o=!1,i={site_id:e,command:t,data:r,response_data:{caught_output:"",reply:a}},e=g('.updraftcentral_site_row[data-site_id="'+e+'"');return UpdraftCentral.send_ajax("cache_response",i,null,"via_mothership_encrypting",e,function(e,t,r){"ok"===t&&e.hasOwnProperty("data")&&(void 0!==udclion.sites_info[i.command]&&(-1!==(t=udclion.sites_info[i.command].findIndex(s,i.site_id))?udclion.sites_info[i.command][t]=e.data:udclion.sites_info[i.command].push(e.data)),n.resolve(e.data),o=!0),o||n.reject()}),n.promise()},this.get_cached_response=function(a,e){if(void 0!==udclion.sites_info[e]&&udclion.sites_info[e]){e=udclion.sites_info[e];if(e.length){e=g.map(e,function(e,t){if(a!=e.site_id)return null;var r=JSON.parse(e.response);return r.hasOwnProperty("reply")&&r.reply?{created:e.created,reply:r.reply}:void 0});if(e.length)return e[0]}}return null},this.is_data_good_to_use=function(e){return parseInt(dayjs().diff(dayjs.unix(e),"hour"))<12},this.get_sites_information=function(){var a=g.Deferred(),n=!1;return UpdraftCentral.send_ajax("get_sites_information",{},null,"via_mothership_encrypting",null,function(e,t,r){"ok"===t&&e.hasOwnProperty("sites_info")&&(a.resolve(e.sites_info),n=!0),n||a.reject()}),a.promise()},this.set_requested_mode=function(){var e,t=window.location.href,r=[];if(-1!==t.indexOf("?")&&(r=t.slice(t.indexOf("?")+1).split("&")).length)for(var a,n=0;n<r.length;n++)"uc_module"===(a=r[n].split("="))[0]&&a[1].length&&void 0!==(e=g("#updraft-menu-item-"+a[1]))&&e&&e.length&&(u.uc_module=a[1],g("#updraftcentral_dashboard_existingsites").on("updraftcentral_sites_loaded",function(e,t){set_dashboard_mode(t.module)}));void 0===u.uc_module&&(u.uc_module=!1)},this.plupload_init=function(h,t){var n,o,s,i;function m(e,t){g("#filelist").find("div#"+t.id).remove(),o.removeFile(t),e.removeFile(t),e.stop(),e.start()}function d(t,r){var e,a,n;return void 0===r&&(r=jQuery.Deferred()),t.length?void 0!==(e=t.shift())&&(e=new UpdraftCentral_Site(e),s.exists(e.id)||(a=e,n=jQuery.Deferred(),i.load_credentials(a).then(function(e){var t=!1;!e.hasOwnProperty("request_filesystem_credentials")||(e=e.request_filesystem_credentials).hasOwnProperty(h+"s")&&UpdraftCentral_Library.parseBool(e[h+"s"])&&(t=!0),t?i.get_credentials(a).then(function(e){a.site_credentials=e.site_credentials,a.save_credentials_in_browser=e.save_credentials_in_browser,a.save_credentials_in_browser&&UpdraftCentral.storage_set("filesystem_credentials_"+a.site_hash,a.site_credentials,!0),n.resolve(a)}).fail(function(e){n.resolve({})}):n.resolve(a)}).fail(function(e){n.resolve(a)}),n.promise().then(function(e){e.hasOwnProperty("id")&&e.id&&s.add(e.id,{id:e.id,description:e.site_description,filesystem_credentials:e.site_credentials}),d(t,r)}))):r.resolve(),r.promise()}void 0!==h&&(n=JSON.parse(udclion[h].plupload_config),o=new plupload.Uploader(n),s=new UpdraftCentral_Collection,i=new UpdraftCentral_Credentials,o.bind("Init",function(e){var t=g("#plupload-upload-ui");e.features.dragdrop?(t.addClass("drag-drop"),g("#drag-drop-area").bind("dragover.wp-uploader",function(){t.addClass("drag-over")}).bind("dragleave.wp-uploader, drop.wp-uploader",function(){t.removeClass("drag-over")})):(t.removeClass("drag-drop"),g("#drag-drop-area").unbind(".wp-uploader"))}),o.init(),o.bind("FilesAdded",function(r,a){var e;n.hasOwnProperty("max_file_count")&&n.max_file_count&&(a.length&&(e=parseInt(n.max_file_count),a=a.splice(0,e)),o.files.length&&(g.each(o.files,function(e,t){t.id!==a[0].id&&(o.removeFile(t),r.removeFile(t))}),g("#filelist").empty())),plupload.each(a,function(e){return/\.zip$/.test(e.name)?void g("#filelist").append('<div class="file" id="'+e.id+'"><b>'+e.name+"</b> (<span>"+plupload.formatSize(0)+"</span>/"+plupload.formatSize(e.size)+') <div class="fileprogress"></div></div>'):(UpdraftCentral_Library.dialog.alert("<h2>"+udclion[h].install_zip_heading+"</h2><p>"+e.name+": "+udclion[h].notarchive+"</p>"),o.removeFile(e),void r.removeFile(e))}),r.refresh(),r.start()}),o.bind("UploadProgress",function(e,t){g("#"+t.id+" .fileprogress").width(t.percent+"%"),g("#"+t.id+" span").html(plupload.formatSize(parseInt(t.size*t.percent/100)))}),o.bind("Error",function(e,t){UpdraftCentral_Library.dialog.alert("<h2>"+udclion[h].install_zip_heading+"</h2><p>"+udclion[h].uploaderr+" (code "+t.code+") : "+t.message+" - "+udclion[h].makesure+"</p>")}),o.bind("BeforeUpload",function(n,o){new UpdraftCentral_Credentials;var i,e=t.get_selected_sites();return e.hasOwnProperty("sites")&&e.sites.count()?(e=e.sites,i=g("#uc-install-status"),s.clear(),i.append('<span id="load-site-creds-msg">'+udclion[h].creds_check+"</span>"),i.append('<div class="injected-spinner updraftcentral_spinner"></div>'),d(e.get_items()).then(function(e){var t,r,a;i.find("span#load-site-creds-msg").remove(),i.find("div.injected-spinner").remove(),t=n,r=o,(a=s.get_items()).length?UpdraftCentral_Library.dialog.confirm("<h2>"+udclion[h].install_zip_heading+"</h2><p>"+udclion[h].install_zip_message+"</p>",function(e){e=e?1:0;g.extend(t.settings.multipart_params,{site_id:UpdraftCentral.$site_row.data("site_id"),activate:e,sites:UpdraftCentral_Library.base64_encode(JSON.stringify(a))});e=UpdraftCentral.$site_row.find(".updraftcentral_row_extracontents");UpdraftCentral.set_loading(e),r.status=plupload.UPLOADING,t.trigger("UploadFile",r)},null,{confirm:udclion.yes_activate,cancel:udclion.do_not_activate}):m(t,r)})):m(n,o),!1}),o.bind("ChunkUploaded",function(r,a,e){var n,o,i,e=JSON.parse(e.response),s=a.status,d="",l=0;e.hasOwnProperty("e")&&e.e?(0<UpdraftCentral.get_debug_level()&&console.log(udclion.error+": "+udclion[h].install_zip_heading.toLowerCase()+" ("+a.name+"); "+udclion.message+" ("+e.e+");"),UpdraftCentral_Library.dialog.alert("<h2>"+udclion[h].install_zip_heading+"</h2><p>"+vsprintf(udclion[h].upload_failed,[a.name,"<br/>",e.e])+"</p>"),r.removeFile(a),plupload.UPLOADING==s&&plupload.STARTED==r.state&&(r.stop(),r.start())):(g.each(e,function(e,t){n=t.site_description,((o=t.response).hasOwnProperty("error")&&o.error||o.hasOwnProperty("responsetype")&&"error"==o.responsetype)&&(i=udclion[h].upload_cutoff,o.hasOwnProperty("message")&&o.message?i=o.message:o.hasOwnProperty("data")&&o.data&&(i=o.data),0<UpdraftCentral.get_debug_level()&&console.log(udclion.error+": "+udclion[h].install_zip_heading.toLowerCase()+" ("+a.name+"); "+n+": "+i),l<3&&(d+=n+": "+i+"<br/>",l++),s=a.status,r.removeFile(a),plupload.UPLOADING==s&&plupload.STARTED==r.state&&(r.stop(),r.start()))}),0<l&&UpdraftCentral_Library.dialog.alert("<h2>"+udclion[h].install_zip_heading+"</h2><p>"+vsprintf(udclion[h].upload_failed,[a.name,"<br/>",d])+"</p>"))}),o.bind("FileUploaded",function(t,r,a){var e=UpdraftCentral.$site_row.find(".updraftcentral_row_extracontents");if(UpdraftCentral.done_loading(e),"200"==a.status)try{var n,o,i,s,d,l,c=JSON.parse(a.response),_=0,u="",p="",f=0;c.hasOwnProperty("e")&&c.e?(0<UpdraftCentral.get_debug_level()&&console.log(udclion.error+": "+udclion[h].install_zip_heading.toLowerCase()+" ("+r.name+"); "+udclion.message+" ("+c.e+");"),p=c.e):g.each(c,function(e,t){n=t.site_description,(o=t.response).hasOwnProperty("installed")&&o.installed?(u=o.installed_data.Name,_++):(o.hasOwnProperty("message")&&o.message?(0<UpdraftCentral.get_debug_level()&&console.log(udclion.error+": "+udclion[h].install_zip_heading.toLowerCase()+" ("+r.name+"); "+n+": "+o.message),i=o.message):(i=sprintf(udclion[h].general_error,JSON.stringify(o)),o.hasOwnProperty("error")&&o.error&&o.hasOwnProperty("code")&&o.code&&(t=o.data,i=t&&t.hasOwnProperty("message")&&t.message?t.message:"string"==typeof t&&t.length?t:void 0!==udclion[h][o.code]?udclion[h][o.code]:sprintf(udclion[h].general_error,o.code)),0<UpdraftCentral.get_debug_level()&&console.log(udclion.error+": "+udclion[h].install_zip_heading.toLowerCase()+" ("+r.name+"); "+n+": "+i)),f<3&&(p+=n+": "+i+"<br/>",f++))}),_!==c.length?UpdraftCentral_Library.dialog.alert("<h2>"+udclion[h].install_zip_heading+"</h2><p>"+vsprintf(udclion[h].upload_failed,[r.name,"<br/>",p])+"</p>"):(s=t.settings.multipart_params,d=udclion[h].installed,s.hasOwnProperty("activate")&&s.activate&&(d=udclion[h].installed_activated),l=vsprintf(udclion[h].install_success_message,[d,'"'+u+'"']),UpdraftCentral_Library.dialog.alert("<h2>"+udclion[h].install_zip_heading+"</h2><p>"+l+"</p>")),m(t,r)}catch(e){0<UpdraftCentral.get_debug_level()&&(console.log(udclion.error+": "+udclion[h].install_zip_heading.toLowerCase()+" ("+r.name+"); "+n+" - "+udclion[h].jsonnotunderstood),console.log(e),console.log(a)),m(t,r)}else 0<UpdraftCentral.get_debug_level()&&(console.log(udclion.error+": "+udclion[h].install_zip_heading.toLowerCase()+" ("+r.name+"); "+n+" ("+udclion[h].details_follows+"):"),console.log(a)),m(t,r)}))},this.init_tooltip=function(){var e=g("#updraft-central-sidebar-button span.arrow-left");e.data("animation",!1),e.tooltip({container:g("#updraftcentral_dashboard").get(0),trigger:"hover",placement:"top",title:udclion.collapse_menu,boundary:"viewport"});e=g("#updraft-central-sidebar-button span.arrow-right");e.data("animation",!1),e.tooltip({container:g("#updraftcentral_dashboard").get(0),trigger:"hover",placement:"top",title:udclion.expand_menu,boundary:"viewport"}),g('[data-toggle="tooltip"]').tooltip({container:g("#updraftcentral_dashboard").get(0),trigger:"hover",placement:"top",boundary:"viewport"}),g('[data-toggle="tooltip"]').tooltip("disable")},this.get_wporg_metadata=function(r,a,n,o){var e=UpdraftCentral.storage_get("wporg_api_"+r+"_"+a,600);e&&e.hasOwnProperty("name")?o.call(this,e,n):(e="theme"==r?"https://api.wordpress.org/themes/info/1.1/":"https://api.wordpress.org/plugins/info/1.1/",jQuery.getJSON(e,{action:r+"_information",request:{slug:a,fields:"theme"===r?{description:!0,sections:!0,rating:!0,ratings:!0,downloaded:!0,downloadlink:!0,last_updated:!0,screenshot_url:!0,parent:!0}:{short_description:!0,icons:!0}}},function(e,t){"success"==t&&(UpdraftCentral.storage_set("wporg_api_"+r+"_"+a,e,!0),o.call(this,e,n))}))},this.search_wporg=function(e,t,r,a,n){var o="theme"===e?{description:!0,sections:!1,rating:!0,ratings:!0,downloaded:!0,downloadlink:!0,last_updated:!0,screenshot_url:!0,parent:!0}:{sections:!1,added:!1,tags:!1,compatibility:!1,donate_link:!1,icons:!0};n=void 0!==n?n:10,a=void 0!==a?a:1,jQuery.getJSON("https://api.wordpress.org/"+e+"s/info/1.1/",{action:"query_"+e+"s",request:{search:t,per_page:n,page:a,fields:o}},function(e,t){"success"==t&&r.call(this,e)})},this.save_timeout=function(e,t){var a=g.Deferred();return UpdraftCentral.send_ajax("save_timeout",{timeout:e},null,"via_mothership_encrypting",t,function(e,t,r){"ok"===t&&e.hasOwnProperty("message")&&("success"===e.message?a.resolve():a.reject())}),a.promise()},this.save_settings=function(e,t){var a=g.Deferred();return UpdraftCentral.send_ajax("save_settings",e,null,"via_mothership_encrypting",t,function(e,t,r){"ok"===t&&e.hasOwnProperty("message")&&("success"===e.message?a.resolve():a.reject())}),a.promise()},this.maybe_ask_credentials=function(e,t){var r=jQuery.Deferred(),a=new UpdraftCentral_Credentials,n=new UpdraftCentral_Site(e);return a.load_credentials(n).then(function(e){e=e.request_filesystem_credentials;void 0!==e[t]&&UpdraftCentral_Library.parseBool(e[t])?a.get_credentials(n).then(function(e){r.resolve({site:n,credentials_required:!0,credentials:e.site_credentials,store_credentials:e.save_credentials_in_browser})}).fail(function(e){r.reject(e)}):r.resolve({site:n,credentials_required:!1})}).fail(function(e){r.reject(e)}),r.promise()},this.is_plugin_active=function(e,t,r){var a=g.Deferred(),t={plugin:t};return void 0!==r&&r&&(t.slug=r),UpdraftCentral.send_site_rpc("plugin.is_plugin_installed",t,e,function(e,t,r){"ok"!==t||e.data.error?a.reject(e):a.resolve(e.data)}),a.promise()},this.activate_plugin=function(e,t,r){var a=g.Deferred(),t={plugin:t};return void 0!==r&&r&&(t.slug=r),UpdraftCentral.send_site_rpc("plugin.activate_plugin",t,e,function(e,t,r){"ok"!==t||e.data.error?a.reject(e):a.resolve(e.data)}),a.promise()},this.install_activate_plugin=function(t,r,a){var n=g.Deferred();return UpdraftCentral.maybe_ask_credentials(t,"plugins").then(function(e){e.credentials_required&&e.store_credentials&&UpdraftCentral.storage_set("filesystem_credentials_"+e.site.site_hash,e.credentials,!0);e={plugin:r,slug:a,filesystem_credentials:e.credentials};UpdraftCentral.send_site_rpc("plugin.install_activate_plugin",e,t,function(e,t,r){"ok"!==t||e.data.error?n.reject(e):n.resolve(e.data)})}).fail(function(e){n.reject(e)}),n.promise()},this.init_process_listener=function(){g("a.updraft-sub-menu-link").on("click",function(e){var t=g(this).attr("data-selector"),r=g(this).attr("data-module"),r=g("#updraft-menu-item-"+r),t=g(t);r.length&&r.trigger("click"),t.length&&t.trigger("click")}),g(".updraft-sub-menu-icon").on("click",function(e){e.stopPropagation();var t=g(this).find(".updraft-sub-menu"),e=g(this).closest(".updraft-menu-item-container"),n=e.find("button.updraft-menu-item");g(".updraft-menu-item-container > .updraft-sub-menu").each(function(){var e=g(this),t=g(this).closest(".updraft-menu-item-container"),r=t.find(".updraft-sub-menu-icon"),a=t.find("button.updraft-menu-item");n.attr("id")!==a.attr("id")&&o(r,e,t)}),o(g(this),t,e)}),g(document).ajaxStop(function(){0===g.active&&(u.ajax_request_processing=!1,u.uc_action_data=[],u.event_trigger.clear(),0<f&&console.log("init_process_listener (ajaxStop): ajax_request_processing=false, uc_action_data=[], event_trigger=cleared; (reset flag/vars for in-progress blocking)."))}),g(document).ajaxSend(function(e,t,r){u.ajax_request_processing=!0,0<f&&console.log("init_process_listener (ajaxSend): ajax_request_processing=true; (setting flag for in-progress blocking).")}),g("#updraftcentral_dashboard").on("updraftcentral_dialog_opened",function(e){var t;!g.fullscreen.isFullScreen()||(t=g("#updraftcentral_dashboard_wrapper.updraft-fullscreen").find("#updraftcentral_dashboard")).length&&0===t.find("div.modal-backdrop").length&&g(document.body).find(".modal-backdrop.show").appendTo(t)}),g("#updraftcentral_dashboard").on("updraftcentral_dialog_closed",function(e){var t,r,a;g.fullscreen.isFullScreen()&&(t=(a=g("#updraftcentral_dashboard_wrapper.updraft-fullscreen")).find("#updraftcentral_dashboard div.bootbox.modal.show"),r=a.find("#updraftcentral_dashboard #updraftcentral_modal_dialog.modal.show"),0!==t.length||0!==r.length||(a=a.find("#updraftcentral_dashboard div.modal-backdrop.show")).length&&a.remove())}),g(window).resize(function(){var e;Math.max(document.documentElement.clientWidth,window.innerWidth||0)<=t?(e=g("#updraft-central-navigation-sidebar").css("width"),0<=g("#updraft-central-navigation-sidebar").position().left&&g("#updraft-mobile-menu").trigger("click"),"60px"===e&&g("#updraft-central-sidebar-button").trigger("click"),g("#updraft-central-navigation-sidebar").hasClass("active")&&g("#updraft-central-content").prepend('<div class="mobile-menu-backdrop"></div>'),g("#updraftcentral_dashboard").on("click",function(e){"updraft-central-navigation-sidebar"===g(e.target).attr("id")||g(e.target).hasClass("updraft-mobile-menu")||g("#updraft-central-navigation-sidebar").hasClass("active")&&(g("#updraft-central-navigation-sidebar").toggleClass("active"),g("#updraft-central-content > .mobile-menu-backdrop").remove())})):(g("#updraft-central-navigation-sidebar").removeClass("active"),g("#updraft-central-content > .mobile-menu-backdrop").remove())}),g(window).trigger("resize")},this.save_shortcut=function(e,t){var a=g.Deferred();return UpdraftCentral.send_ajax("shortcuts",{name:e,key:t},null,"via_mothership_encrypting",null,function(e,t,r){"ok"===t&&e.hasOwnProperty("message")&&("success"===e.message?a.resolve():a.reject())}),a.promise()},this.load_shortcuts=function(){var a=g.Deferred();return UpdraftCentral.send_ajax("shortcuts",{},null,"via_mothership_encrypting",null,function(e,t,r){"ok"===t&&e.hasOwnProperty("shortcuts")&&a.resolve(e.shortcuts)}),a.promise()},this.site_order=function(){g("#updraftcentral_dashboard_existingsites").sortable({axis:"y",start:function(e,t){g(".updraft_site_actions").removeClass("open")},stop:function(e,t){site_order_array=g(this).sortable("toArray",{attribute:"data-site_id"}),UpdraftCentral.send_ajax("manage_site_order",{site_order:site_order_array},null,"via_mothership_encrypting",null,function(e,t,r){"ok"==t?e.hasOwnProperty("message")&&"fail"===e.message&&UpdraftCentral_Library.dialog.alert(udclion.error_saving_site_order):(console.log("Expected site order data not found:"),console.log(e))})}})},this.site_order(),this.convertTo24HourFormat=function(e){var t=e.split(" ");if(void 0===t[1])return t[0];var r=t[1].split(":"),a=parseInt(r[0]),e=parseInt(r[1]),r=r[1].match(/\d{1,}(.*)/)[1];return 0!==r.length&&(r=1===r.length?r.toLowerCase()+"m":r.toLowerCase(),12==a&&"am"==r&&0<=e&&e<=59&&(a-=12),1<=a&&a<=11&&"pm"==r&&0<=e&&e<=59&&(a+=12)),a=a<10?"0"+a.toString():a.toString(),e=e<10?"0"+e.toString():e.toString(),t[0]+" "+a+":"+e},Handlebars.registerHelper("sanitize_html",function(e){return new Handlebars.SafeString(UpdraftCentral_Library.sanitize_html(e))}),Handlebars.registerHelper("timeago",function(e,t){return void 0===e||void 0===t?"":("string"!=typeof t&&(t="YYYY-MM-DD HH:mm"),dayjs.extend(dayjs_plugin_relativeTime),e=UpdraftCentral.convertTo24HourFormat(e),new Handlebars.SafeString(dayjs(e,t).fromNow()))}),Handlebars.registerHelper("shorten",function(e){if(void 0===e)return"";var t=e.split("."),e=t[0];return e.length<150&&void 0!==t[1]&&(e+=". "+t[1]),new Handlebars.SafeString(e+".")}),Handlebars.registerHelper("normalize",function(e){return void 0===e?"":(e=e.replace(/&#(\d+);/g,function(e,t){return String.fromCharCode(t)}).replace(/&amp;/g,"&"),new Handlebars.SafeString(e))}),Handlebars.registerHelper("toLocale",function(e){return void 0===e?"":new Handlebars.SafeString(e.toLocaleString())}),Handlebars.registerHelper("render_star",function(e,t){if(void 0===e||void 0===t)return"";for(var e=((e=parseInt(e))/20).toString().split("."),r=parseInt(e[0]),a=void 0!==e[1]?parseInt(e[1]):0,n="",o=!1,i=1;i<=5;i++)i<=r?n+='<span class="dashicons dashicons-star-filled"></span>':0===a||o?n+='<span class="dashicons dashicons-star-empty"></span>':(n+=8<=a?'<span class="dashicons dashicons-star-filled"></span>':a<=3?'<span class="dashicons dashicons-star-empty"></span>':'<span class="dashicons dashicons-star-half"></span>',o=!0);return new Handlebars.SafeString(n+" ("+t.toLocaleString()+")")}),Handlebars.registerHelper("strip_tags",function(e){if(void 0===e||"string"!=typeof e)return"";var t=document.createElement("DIV");return t.innerHTML=e,new Handlebars.SafeString(t.innerText)}),Handlebars.registerHelper("sprintf",function(){var e,t="";return"function"==typeof sprintf&&void 0!==arguments&&(e=[].slice.call(arguments),t=sprintf.apply(null,e)),new Handlebars.SafeString(t)}),Handlebars.registerHelper("ifeq",function(e,t,r){return(e="string"!=typeof e&&null!=e?e.toString():e)===(t="string"!=typeof t&&null!=t?t.toString():t)?r.fn(this):r.inverse(this)}),Handlebars.registerHelper("ifneq",function(e,t,r){return(e="string"!=typeof e?e.toString():e)!==(t="string"!=typeof t?t.toString():t)?r.fn(this):r.inverse(this)}),Handlebars.registerHelper("ifset",function(e,t,r){return(e="string"!=typeof e?e.toString():e)===(t="string"!=typeof t?t.toString():t)?new Handlebars.SafeString(r+'="'+r+'"'):""}),Handlebars.registerHelper("ifempty",function(e,t){return void 0!==e&&e&&e.length?"":new Handlebars.SafeString(t)}),this.set_current_site_row=function(e){UpdraftCentral.$site_row=e},this.register_event_handler=function(e,t,r){jQuery(document).off(e,t).on(e,t,function(e){u.check_processing_state(e)||(e=[],void 0!==r.arguments&&r.arguments&&r.arguments.length&&(e=r.arguments),r.apply(this,e))})},this.set_loading=function(e){e.css("opacity","0.3"),UpdraftCentral_Library.disable_actions(),g(".updraftcentral_spinner").not(":visible")&&(g(".injected-spinner.updraftcentral_spinner").length||g("#updraftcentral_dashboard").append('<div class="injected-spinner updraftcentral_spinner"></div>'))},this.done_loading=function(e,t){var r=jQuery.Deferred();return e.css("opacity","1.0"),g(".injected-spinner.updraftcentral_spinner").length&&g(".injected-spinner.updraftcentral_spinner").remove(),UpdraftCentral_Library.enable_actions(),t?e.slideUp(500,function(){e.html(t),r.resolve()}).slideDown(500):r.resolve(),r.promise()},this.set_debug_level=function(e){f=e},this.get_debug_level=function(){return parseInt(f)},this.initiate_modal_close_listener=function(e){g('.modal-dialog button[data-dismiss="modal"]').on("click",function(){"function"==typeof e&&e&&(e.apply(null,[]),g('.modal-dialog button[data-dismiss="modal"]').off("click")),g("#updraftcentral_dashboard").trigger("updraftcentral_dialog_closed")})},this.open_modal=function(e,t,r,a,n,o,i,s,d){a=void 0!==a?a:udclion.go,o=void 0===o||o,i=void 0!==i?i:"",g("#updraftcentral_modal_dialog .modal-dialog").removeClass().addClass("modal-dialog "+i),g("#updraftcentral_modal_dialog .modal-title").html(e),o&&(t=UpdraftCentral_Library.sanitize_html(t)),g("#updraftcentral_modal_dialog .modal-body").html(t),!1===a?g("#updraftcentral_modal_dialog button.updraft_modal_button_goahead").hide():g("#updraftcentral_modal_dialog button.updraft_modal_button_goahead").html(a).show(),l=r,null!=n&&n.call(this),UpdraftCentral.initiate_modal_close_listener(s),g("#updraftcentral_modal_dialog").modal(),g("#updraftcentral_modal_dialog #updraftcentral_addsite_tabs").length&&g("#updraftcentral_addsite_tabs").tabs().addClass("ui-tabs-vertical ui-helper-clearfix"),g("#updraftcentral_dashboard").trigger("updraftcentral_dialog_opened"),null!=d&&d.call(this)},this.get_site_heading=function(e){var t=e.data("site_description"),e=e.data("site_url");return(t=t==e?"":t)?'<a href="'+e+'">'+t+"</a>":'<a href="'+e+'">'+e+"</a>"},this.close_modal=function(){g("#updraftcentral_modal_dialog").modal("hide"),g("#updraftcentral_dashboard").trigger("updraftcentral_dialog_closed")},this.register_row_clicker=function(r,a,n,o){o=void 0!==o?o:"click",n=void 0!==n&&n,params={},g("#updraftcentral_dashboard_existingsites_container").on(o,".updraftcentral_site_row "+r,params,function(e){var t=UpdraftCentral_Library.md5("_key_"+g(this).get(0).className+"_"+r);u.event_trigger.exists(t)&&0!==g.active||".btn-group > button"!==r&&u.check_processing_state(e)||(u.event_trigger.add(t,1),"keypress"!=o&&e.preventDefault(),UpdraftCentral.$site_row=g(this).closest(".updraftcentral_site_row"),t=UpdraftCentral.$site_row.data("site_id"),n&&(g('#updraftcentral_dashboard_existingsites .updraftcentral_site_row:not([data-site_id="'+t+'"]), #updraftcentral_dashboard_existingsites .updraftcentral_row_divider').slideUp(),g(".updraftcentral_mode_actions .updraftcentral_action_choose_another_site").show(),g("#updraftcentral_dashboard_existingsites").sortable("disable"),g("#updraftcentral-search-area").hide(),UpdraftCentral.$site_row.addClass("sortable-is-disabled")),a.call(this,UpdraftCentral.$site_row,t,e))})};var d=this.register_row_clicker;this.register_modal_listener=function(e,t,r){r=void 0!==r?r:"click",params={},g("#updraftcentral_modal").on(r,e,params,function(e){t.call(this,e)})},g("#updraftcentral_modal_dialog button.updraft_modal_button_goahead").click(function(){!0===l?this.close_modal():l.call(this)});var c={};this.register_listener_processor=function(e,t){c[e]=t},setInterval(function(){g("#updraftcentral_notice_container .updraftcentral_listener").each(function(e){var t,a,n=g(this).data("site_id"),r=g(this).data("type"),o=this,i=g('#updraftcentral_dashboard_existingsites .updraftcentral_site_row[data-site_id="'+n+'"');g(this).data("finished")||(1<f&&console.log("poll_listeners(): site_id="+n+", listener_type="+r),0<i.length&&c.hasOwnProperty(r)?0===(t=c[r].call(this,o,i,n))?(g(this).data("finished",!0),g("#updraftcentral_dashboard_existingsites").trigger("updraftcentral_listener_finished_"+r,{site_id:n,site_row:i,listener_row:o,listener_type:r}),g(o).clearQueue().delay(1e4).slideUp("slow",function(){g(this).remove()})):1===t?(g(this).data("finished",!0),g("#updraftcentral_dashboard_existingsites").trigger("updraftcentral_listener_finished_"+r,{site_id:n,site_row:i,listener_row:o,listener_type:r})):null!=t&&t.hasOwnProperty("call")&&(a=t.call,UpdraftCentral.send_site_rpc(t.call,t.data,i,function(e,t,r){"ok"==t&&!1!==e&&e.hasOwnProperty("data")&&(c.hasOwnProperty(a)?c[a].call(this,o,i,n,e.data):(console.log("UpdraftCentral: listener type "+a+" has no registered processor (dump of all registered processors follows)"),console.log(c)))})):0<i.length?(console.log("UpdraftCentral: listener type "+r+" has no registered processor (dump of all registered processors follows)"),console.log(c)):console.log("UpdraftCentral: listener for site_id="+n+" with type "+r+": site row not found"))})},e);var h=[];function p(e,t){var r=e.data("site_remote_public_key"),a=e.data("site_local_private_key"),n=this.get_contact_url(e),o=e.data("site_id"),i=e.data("key_name_indicator"),s=e.data("remote_user_id");"via_mothership_encrypting"==(t=void 0===t||"direct_manual_auth"!=t&&"via_mothership"!=t&&"via_mothership_encrypting"!=t&&"direct_jquery_auth"!=t?"direct_default_auth":t)&&(console.warn("UpdraftCentral: A site ("+o+", "+n+") routed via_mothership_encrypting was passed into get_site_udrpc"),console.log(e));var d=!1;"direct_default_auth"==t?(navigator.userAgent.toLowerCase().indexOf("firefox"),connection_method="direct_jquery_auth"):(connection_method=t,"via_mothership"==connection_method&&(d={action:"updraftcentral_dashboard_ajax",subaction:"site_rpc",component:"dashboard",nonce:udclion.updraftcentral_dashboard_nonce,site_id:o,site_rpc_preencrypted:1}));var l=e.data("send_cors_headers");void 0===l&&(l=1);var c,_="direct_manual_auth"==connection_method?"manual":"jquery",u={},p=n;return"via_mothership_encrypting"!=connection_method&&"via_mothership"!=connection_method?void 0!==(c=e.data("http_username"))&&c&&(u.username=c,void 0!==(e=e.data("http_password"))&&(u.password=e)):p=udclion.ajaxurl,0<f&&(console.log("UDRPC communications method: site_id="+o+", name_indicator="+i+", site_url="+n+", comms_url="+p+", remote_user_id="+s+", connection_method="+t+"/"+connection_method+", send_cors_headers="+l),1<f&&(console.log("Remote public key follows"),console.log(r))),function(e,t,r,a,n,o,i,s,d){{var l;void 0!==h[e]?l=h[e]:(o=void 0===o||o,(l=new UpdraftPlus_Remote_Communications(t)).set_key_local(a),l.set_key_remote(r),l.activate_replay_protection(),/\/admin-ajax.php$/.test(n)&&(n+="?action=updraft_central"),l.set_destination_url(n),void 0!==i&&l.set_http_credentials(i),void 0!==s&&l.set_auth_method(s),void 0!==d&&!1!==d&&(l.set_message_wrapper(d),l.set_message_unwrapper(function(e){var t=v(e,2,!1);if(!0===t){if(e.hasOwnProperty("wrapped_response"))return e.wrapped_response;t="wrapped_response_not_found"}return console.error("UDRPC: Attempt to unwrap the message failed (code: "+t+")"),1<f&&console.log(e),!1})),l.set_cors_headers_wanted(o),h[e]=l)}0<f&&(e=2<f?2:1,l.set_debug_level(e));return l}(o+" "+connection_method,i,r,a,p,l,u,_,d)}function m(e,t,r,a,n,o,i){if(!(UpdraftCentral.reloaded&&0<parseInt(g.active)&&"error"==t)){var s,d,l=void 0!==i&&i&&i.length?i.data("site_description")+" - ":"";if(o=void 0===o||o,"error"==t?(console.error("process_ajax_response: return code: "+t+", error_code: "+r+" - parsed response follows"),console.log(e)):0<f&&(console.log("process_ajax_response: return code: "+t+" - parsed response follows"),console.log(e)),a&&"ok"==t&&e.hasOwnProperty("response")&&"rpcerror"==e.response)if(t="error",r="rpc_unknown_error",e.hasOwnProperty("data")&&e.data.hasOwnProperty("code"))return r=e.data.code,console.error("UpdraftCentral: RPC: Error occurred ("+r+" - "+i.data("site_description")+"); data follows"),console.log(e.data),e=e.data.data,void(!0!==n.call(this,e,t,r)&&(d=udclion.js_exception_occurred+" ("+r+")",udclion.rpcerrors.hasOwnProperty(r)&&(d="rpc_fatal_error"==r&&e.hasOwnProperty("message")?sprintf(udclion.rpcerrors[r],e.message):udclion.rpcerrors[r]),o&&UpdraftCentral_Library.dialog.alert("<h2>"+l+udclion.communications_error+"</h2>"+d)));"error"==t&&(s=udclion.general_js_comms_failure,i=!0,d=udclion.error,"json_parse_fail"==(r=2==a&&"unwrapper_failure"==r&&e.hasOwnProperty("code")?e.code:r)?-1<e.indexOf("<html")&&(console.error("UpdraftCentral: JSON parse fail: looks like html was returned - remote plugin is probably not installed/inactive/blocked"),s=udclion.general_js_comms_failure,d=udclion.communications_error):"response_empty"==r||"http_post_fail"==r?(s=udclion.general_js_comms_failure,d=udclion.communications_error):"timeout"==r?(s=udclion.comms_failure_timeout,d=udclion.communications_error+" - "+udclion.timeout):"unauthorized"==r?(s=udclion.comms_failure_unauthorised,d=udclion.communications_error):"unknown_response"==r?(s=udclion.unknown_response,d=udclion.communications_error):"cannot_contact_localdev"==r?(d=udclion.communications_error,s=e.message,e.hasOwnProperty("request_info")&&e.request_info.hasOwnProperty("method")&&e.request_info.hasOwnProperty("use_method")&&e.request_info.method!=e.request_info.use_method&&(s+="<br>"+udclion.localdev_can_work_better_with_https)):"unexpected_http_code"==r&&a&&e.hasOwnProperty("data")&&null!==e.data&&e.data.hasOwnProperty("headers")&&e.data.headers.hasOwnProperty("www-authenticate")&&0==e.data.headers["www-authenticate"].search(/Digest/i)?(s=e.message,s+="<br>"+udclion.digest_auth_not_supported):"unexpected_http_code"==r&&a&&e.hasOwnProperty("data")&&null!==e.data&&e.data.hasOwnProperty("response")&&e.data.response.hasOwnProperty("code")&&401==e.data.response.code?s=udclion.comms_failure_unauthorised+' <a href="#" class="updraftcentral_site_editdescription">'+udclion.open_site_configuration+"...</a>":e.hasOwnProperty("message")?(s=e.message,a||(i=!1)):(i=!1,s+="<br>"+udclion.error_code+": "+r),e.hasOwnProperty("status")&&401==e.status?s=udclion.comms_failure_unauthorised+' <a href="#" class="updraftcentral_site_editdescription">'+udclion.open_site_configuration+"...</a>":"ns_error_dom_bad_uri: access to restricted uri denied"==r&&(s=udclion.comms_failure_unauthorised_by_browser+' <a href="#" class="updraftcentral_site_editdescription">'+udclion.open_site_configuration+"...</a>"),s="<p>"+s+"</p>",i&&(s+='<p><a href="'+udclion.common_urls.connection_checklist+'">'+udclion.go_here_for_connection_help+"</a></p>",s+='<p><a href="#" class="updraftcentral_test_other_connection_methods">'+udclion.test_other_connection_methods+"</a></p>"),e.hasOwnProperty("status")&&200!=e.status&&0!=e.status&&(s+="<p>"+udclion.http_response_status+": "+e.status+"</p>"),g("#updraftcentral_dashboard").trigger("updraftcentral_response_error",{code:t,message:s,title:d}),o&&UpdraftCentral_Library.dialog.alert("<h2>"+l+d+"</h2>"+s)),a&&e.hasOwnProperty("data")&&null!=e.data&&(e.data.hasOwnProperty("php_events")&&g.each(e.data.php_events,function(e,t){console.log("UpdraftCentral: PHP event on remote side: "+t)}),e.data.hasOwnProperty("caught_output")&&console.log("UpdraftCentral: direct output on remote side: "+e.data.caught_output),(e.data.hasOwnProperty("php_events")||e.data.hasOwnProperty("caught_output"))&&(e.data=e.data.previous_data)),n.call(this,e,t,r)}}function v(e,t,r,a,n){return a=void 0===a||a,e.hasOwnProperty("responsetype")&&"error"==e.responsetype?(e.hasOwnProperty("message")&&console.error("UpdraftCentral error via AJAX: "+e.message),"cannot_contact_localdev"==e.code&&(e.request_info={method:method,use_method:use_method}),!1!==r&&m(e,"error",e.code,t,r,a,n),e.code):e.hasOwnProperty("message")||e.hasOwnProperty("code")?(1<f&&console.log(e.responsetype+": "+e.message),t&&(e.hasOwnProperty("php_events")&&g.each(e.php_events,function(e,t){console.info("UpdraftCentral: PHP event on remote side: "+t)}),e.hasOwnProperty("mothership_caught_output")&&console.info("UpdraftCentral: direct output on remote side: "+e.caught_output),e.hasOwnProperty("rpc_response")&&(e=e.rpc_response)),!1!==r&&m(e,"ok",null,t,r,a,n),!0):(console.log(e),!1!==r&&m(e,"error","unknown_response",t,r,a,n),"unknown_response")}function _(){var e=g("#updraftcentral_dashboard_existingsites .updraftcentral_site_row:not(.updraft_site_unlicensed)").length;g("#updraftcentral_licences_in_use").html(e)}function r(){var e=g("#updraftcentral_dashboard").outerWidth();g("body").toggleClass("updraftcentral-small",e<=800),g("body").toggleClass("updraftcentral-medium",800<e&&e<=1200),g("body").toggleClass("updraftcentral-large",1200<e)}function b(e){e.hasOwnProperty("how_many_licences_in_use")&&g(".updraftcentral_licences_in_use").html(e.how_many_licences_in_use),e.hasOwnProperty("how_many_licences_available")&&(e=e.how_many_licences_available<0?"&#8734;":e.how_many_licences_available,g(".updraftcentral_licences_total").html(e))}function w(e,t){void 0!==e&&null!==e.match(/https?:\/\/updraft(plus|central)\.com/)&&(void 0!==t&&t.preventDefault(),e=window.open(e,"_blank"),UpdraftCentral_Library.focus_window_or_error(e))}this.get_contact_url=function(e){return e.data("admin_url").replace(/\/+$/,"")+"/admin-ajax.php"},this.send_ajax=function(e,t,n,r,o,i,a,s){var d=void 0!==n&&n&&n.length?n.data("site_description")+" - ":"";r=void 0!==r?r:"direct_default_auth",a=void 0!==a?a:30,void 0!==udclion.user_defined_timeout&&udclion.user_defined_timeout&&(a=udclion.user_defined_timeout),o=void 0!==o?o:null,s=void 0===s||s;var l="via_mothership"==r||"via_mothership_encrypting"==r?"via_mothership"==r?"server_proxies":"server":"direct",c=null!==n;if(c){var _=n.data("site_unlicensed");if(void 0!==_&&_)return void UpdraftCentral_Library.dialog.alert("<h2>"+d+udclion.error+"</h2>"+udclion.site_unlicensed_message)}if(o&&(g(".updraftcentral_spinner").is(":visible")||g(o).prepend('<div class="updraftcentral_spinner"></div>')),"direct"==l&&"https:"==document.location.protocol&&"http:"==this.get_contact_url(n).substring(0,5).toLowerCase()&&(l="server"),0<f&&(console.log("send_message(ajax_method="+l+", requested_method="+r+", command="+e+", data(follows))"),console.log(t)),u.uc_action_data.push({command:e,data:t,website:d,connection_method:r}),"direct"==l||"server_proxies"==l){if(!c)throw"send_ajax() called with direct method ("+r+"), but no site row object passed in";p(n,r).send_message(e,t,a,function(e,t,r){o&&(g(o).removeClass("updraftcentral_spinner"),g(o).children(".updraftcentral_spinner").remove()),2<f&&(console.log("Raw response, pre-processing, follows"),console.log(e));var a="server_proxies"==l?2:1;try{m(e,t,r,a,i,s,n)}catch(e){UpdraftCentral_Library.dialog.alert("<h2>"+d+udclion.error+"</h2>"+udclion.js_exception_occurred+"<br>"+e.toString()),console.log(e)}})}else{r=0;null!==n&&(r=n.data("site_id"));t={type:"POST",url:udclion.ajaxurl,timeout:1e3*a,headers:{"X-Secondary-User-Agent":"UpdraftCentral-dashboard.js/"+udclion.udc_version},data:{action:"updraftcentral_dashboard_ajax",subaction:c?"site_rpc":e,component:"dashboard",nonce:udclion.updraftcentral_dashboard_nonce,site_id:r,data:c?{command:e,data:t}:t},dataType:"text",success:function(t){if(o&&g(o).children(".updraftcentral_spinner").remove(),void 0===t||""===t)return console.log("UDRPC: the response from the remote site was empty"),void m(t,"error","response_empty",c,i,s,n);try{var r=JSON.parse(t)}catch(e){var a=t.match(/\{"format":.*}/);if(null===a)return console.log(e),console.log(t),void m(t,"error","json_parse_fail",c,i,s,n);t=a[0];try{r=JSON.parse(t);console.log("UpdraftCentral: successfully parsed JSON after removing unwanted elements"),console.log(t)}catch(e){return console.log(e),console.log(t),void m(t,"error","json_parse_fail",c,i,s,n)}}v(t=r,c,i,s,n)},error:function(e,t,r){if(o&&g(o).children(".updraftcentral_spinner").remove(),UpdraftCentral.reloaded||(console.error("UpdraftCentral: Error in AJAX operation"),console.log(e),console.log(t),console.error(r)),"function"==typeof(r=(r=""==r?"http_post_fail":r).hasOwnProperty("statusText")?r.statusText.toString():r).toLowerCase)r=r.toLowerCase();else try{var a=r.toString().toLowerCase();a&&(r=a)}catch(e){}m(e,"error",r,c,i,s,n)}};1<f&&(console.log("UpdraftCentral: jQuery POST: options follow:"),console.log(t)),jQuery.ajax(t)}},r(),g("#updraft-central-navigation-sidebar").on("collapse_expand_complete",r),g(window).resize(function(){var e=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth;t<e&&g("#updraftcentral_dashboard #updraft-central-navigation-sidebar").show(),r()}),g("#updraftcentral_dashboard .updraft-mobile-menu").on("click",function(){(window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth)<=t&&(g("#updraft-central-navigation-sidebar").toggleClass("active"),g("#updraft-central-navigation-sidebar").hasClass("active")?g("#updraft-central-content").prepend('<div class="mobile-menu-backdrop"></div>'):g("#updraft-central-content > .mobile-menu-backdrop").remove())}),this.set_existing_sites_to=function(e){var t=setInterval(function(){0===g.active&&(clearInterval(t),h=[],g("#updraftcentral_dashboard_existingsites").html(e),UpdraftCentral.set_dashboard_mode(!0,!0),_())},500)},this.add_dashboard_notice_singleton=function(e,t,r,a,n){return t=void 0===t?"notice":t,r=void 0===r?3e4:r,(a="undefined"==typeof extradata?{}:extradata).identifier=n=void 0===n?"":n,0===g('#updraftcentral_notice_container .updraftcentral_notice[data-identifier="'+n+'"]').length&&this.add_dashboard_notice(e,t,r,a)},this.add_dashboard_notice=function(e,t,r,a){r=void 0!==r?r:3e4,a=void 0!==a?a:{};var n="";"listener_"==(t=void 0!==t?t:"notice").substr(0,9)&&(n="updraftcentral_listener updraftcentral_listener_"+t.substr(9),a.type=t.substr(9),t="info"),$container=g("#updraftcentral_notice_container");var o='<div class="updraftcentral_notice updraftcentral_notice_new updraftcentral_notice_level_'+t+" "+n+'"';g.each(a,function(e,t){o+="data-"+e+'="'+UpdraftCentral_Library.quote_attribute(t)+'"'});e=g(o+'><button type="button" class="updraftcentral_notice_dismiss"></button><div class="updraftcentral_notice_contents">'+e+"</div></div>");return $container.append(e),r?e.slideDown("medium").delay(3e4).slideUp("slow",function(){g(this).remove()}):e.slideDown("medium"),e},this.create_dashboard_listener=function(e,t,r,a,n){(a=void 0===a?{}:a).site_url=t.data("site_url"),a.site_id=t.data("site_id");n=void 0===n?"<h2>"+t.data("site_description")+"</h2>":n;return this.add_dashboard_notice(n+r,"listener_"+e,!1,a)},g("#updraftcentral_notice_container").on("click",".updraftcentral_notice > .updraftcentral_notice_dismiss",function(){g(this).parents(".updraftcentral_notice").clearQueue().slideUp("slow",function(){this.remove()})}),this.get_dashboard_mode=function(){return g("#updraftcentral_dashboard").data("updraftcentral_mode")},this.check_processing_state=function(e){this.get_dashboard_mode();return!(!u.ajax_request_processing||!u.uc_action_data.length)&&(void 0!==e&&e.preventDefault(),UpdraftCentral_Library.dialog.alert("<h2>"+udclion.notice_heading+"</h2>"+udclion.currently_processing),console.log("Action(s) that blocks progress (follows):"),console.log(u.uc_action_data),!0)},this.set_dashboard_mode=function(e,t,r){var a;u.check_processing_state()||(t=void 0!==t,r=void 0!==r,g("#updraftcentral_dashboard_existingsites").trigger("updraftcentral_dashboard_mode_pre_set",{force:t,new_mode:e,reset:r}),a=this.get_dashboard_mode(),!0===e&&(e=a),!t&&e==a||(r=g("#updraftcentral_dashboard_existingsites_container .updraftcentral_row_extracontents"),g("#updraftcentral_dashboard_existingsites").trigger("updraftcentral_dashboard_mode_set_before",{new_mode:e,previous_mode:a,force:t,extra_contents:r}),a&&g("#updraftcentral_dashboard").removeClass("updraftcentral_mode_"+a),g("#updraftcentral_dashboard_existingsites_container .updraftcentral_row_extracontents").empty(),g("#updraftcentral_dashboard_existingsites .updraftcentral_site_row, #updraftcentral_dashboard_existingsites .updraftcentral_row_divider").show(),g("#updraftcentral_dashboard").data("updraftcentral_mode",e),g("#updraftcentral_dashboard").addClass("updraftcentral_mode_"+e),g("#updraft-menu-item-"+a).removeClass("updraft-menu-item-links-active"),g("#updraft-menu-item-"+e).addClass("updraft-menu-item-links-active"),g("#updraftcentral_dashboard .updraftcentral-hide-in-other-tabs:not(.updraftcentral-show-in-tab-"+e+"), #updraftcentral_dashboard .updraftcentral-hide-in-tab-"+e).hide(),g("#updraftcentral_dashboard .updraftcentral-show-in-tab-"+e+" .updraftcentral-hide-in-tab-initially").hide(),g("#updraftcentral_dashboard .updraftcentral-show-in-tab-"+e+", #updraftcentral_dashboard .updraftcentral-show-in-other-tabs:not(.updraftcentral-hide-in-tab-"+e+")").slideDown(1),g("#updraftcentral_dashboard_existingsites_container").off(),g("#updraftcentral_modal").off(),g("#updraftcentral_dashboard_existingsites").trigger("updraftcentral_dashboard_mode_set",{new_mode:e,previous_mode:a}),g("#updraftcentral_dashboard_existingsites").trigger("updraftcentral_dashboard_mode_set_"+e,{new_mode:e,previous_mode:a}),g("#updraftcentral_dashboard_existingsites").trigger("updraftcentral_dashboard_mode_set_after",{new_mode:e,previous_mode:a}),g("#updraftcentral_dashboard_existingsites").sortable("enable")))},g(".updraftcentral_mode_actions .updraftcentral_action_choose_another_site").click(function(){void 0!==UpdraftCentral.$site_row&&UpdraftCentral.$site_row&&UpdraftCentral.$site_row.hasClass("sortable-is-disabled")&&UpdraftCentral.$site_row.removeClass("sortable-is-disabled"),UpdraftCentral.set_dashboard_mode(!0,!0,!0)}),g("#updraft-central-navigation-sidebar").off("click",".updraft-menu-item").on("click",".updraft-menu-item",function(e){e.stopPropagation();e=g(this).attr("id");if(void 0!==e){if("updraft-menu-item-"!=e.substring(0,18))return console.log("UDCentral: menu item without the ID in the expected format"),void console.log(this);e=e.substring(18);UpdraftCentral.set_dashboard_mode(e),Math.max(document.documentElement.clientWidth,window.innerWidth||0)<=t?(g("#updraft-central-navigation-sidebar").toggleClass("active"),g("#updraft-central-navigation-sidebar").hasClass("active")?g("#updraft-central-content").prepend('<div class="mobile-menu-backdrop"></div>'):g("#updraft-central-content > .mobile-menu-backdrop").remove()):g("#updraft-central-content > .mobile-menu-backdrop").remove()}}),g("#updraft-central-sidebar-button").click(function(){var o=!1,e=60<g("#updraft-central-navigation-sidebar").width()?"60px":"200px",t=g(".updraft-sub-menu:visible");t.length&&t.closest(".updraft-menu-item-container").find(".updraft-sub-menu-icon").trigger("click"),g("#updraft-central-navigation-sidebar").animate({width:e},{step:function(e,t){var r=g("#"+t.elem.id).find("button.updraft-menu-item > span.menu-label"),a=g("#"+t.elem.id).find(".module-visibility"),n=g("#hidden-modules-container").find(".uc-hidden-modules-label"),t=g("#updraft-menu-item-all");e<120?(r.hide(),a.hide(),n.hide(),t.html('<span class="dashicons dashicons-visibility"></span>'),o=!0):(r.show(),a.show(),n.show(),t.html(udclion.show_all),o=!1,g("span.module-visibility > span.dashicons-hidden").show(),g("span.module-visibility > span.dashicons-visibility").show())},complete:function(){o?g('[data-toggle="tooltip"]').tooltip("enable"):g('[data-toggle="tooltip"]').tooltip("disable"),g("#updraft-central-navigation-sidebar").trigger("collapse_expand_complete")}}),g(".updraft-central-sidebar-button-icon").toggle()}),g("#updraftcentral_dashboard .updraftcentral_action_box .updraftcentral_action_manage_sites").click(function(){UpdraftCentral.set_dashboard_mode("sites")}),g("#updraftcentral_dashboard_newsite").click(function(){var e=UpdraftCentral.get_advanced_site_options_html({http_username:"",http_password:""});UpdraftCentral.open_modal(udclion.add_site,UpdraftCentral.template_replace("sites-add-new-modal",{advanced_options:e}),function(){var e,t,r,a=g("#updraftcentral_addsite_key").val();UpdraftCentral.close_modal(),null!=a&&""!==a&&(e=UpdraftCentral_Library.get_serialized_options("#updraftcentral_modal #updraftcentral_editsite_expertoptions .expert_option"),t=g("#updraftcentral_modal #updraftcentral_site_send_cors_headers").is(":checked")?1:0,r=g("#updraftcentral_modal #updraftcentral_site_connection_method").val(),UpdraftCentral.send_ajax("newsite",{key:a,extra_site_info:e,send_cors_headers:t,connection_method:r},null,"via_mothership_encrypting","#updraftcentral_dashboard_existingsites",function(e,t,r){var a,n;"ok"==t&&(e.hasOwnProperty("message")&&(add_dashboard_notice(e.message,"info"),e.hasOwnProperty("sites_html")?UpdraftCentral.set_existing_sites_to(e.sites_html):(console.log("Expected sites_html data not found:"),console.log(e)),e.hasOwnProperty("status_info")&&b(e.status_info)),e.hasOwnProperty("key_needs_sending")&&(n=e.key_needs_sending.key_site_id,a=e.key_needs_sending.url,t=g('#updraftcentral_dashboard_existingsites .updraftcentral_site_row[data-site_id="'+n+'"'),n=e.key_needs_sending.remote_public_key,g(t).prepend('<div class="updraftcentral_spinner"></div>'),n=a+"&action=updraftcentral_receivepublickey&updraft_key_index="+encodeURIComponent(e.key_needs_sending.updraft_key_index)+"&public_key="+encodeURIComponent(UpdraftCentral_Library.base64_encode(n)),n=window.open(n,"_blank","toolbar=no,location=no,status=no,menubar=no,scrollbars=yes,resizable=yes,width=600,height=320"),UpdraftCentral_Library.focus_window_or_error(n)))}))},udclion.add_site,function(){g("#updraftcentral_modal #updraftcentral_site_send_cors_headers").prop("checked",!0)},!1,"addsite_dialog",null,function(){g("#updraftcentral_addsite_key").focus()})}),g("body").on("change","#updraftcentral_import_file",function(){g(this).val().length&&g(".exportsettings_dialog button.updraft_modal_button_goahead").html(udclion.import_settings)}),g("#updraftcentral_dashboard_export_settings").click(function(){UpdraftCentral.open_modal(udclion.export_import_settings,UpdraftCentral.template_replace("sites-export-modal",{}),function(){var e=g("#updraftcentral_modal #updraftcentral_encryption_phrase").val(),t=g("#updraftcentral_modal #updraftcentral_import_file");void 0!==t&&t&&t.val().length?function(e,t,r){var a=g.Deferred();r=void 0!==r?r:30,void 0!==udclion.user_defined_timeout&&udclion.user_defined_timeout&&(r=udclion.user_defined_timeout);var n=new FormData;n.append("action","updraftcentral_dashboard_ajax"),n.append("subaction","import_settings"),n.append("component","dashboard"),n.append("nonce",udclion.updraftcentral_dashboard_nonce),n.append("site_id",0),void 0!==e&&e&&n.append("file",e),void 0!==t&&t&&n.append("data",JSON.stringify(t));var o=g(".exportsettings_dialog");return o.prepend('<div class="updraftcentral_spinner"></div>'),n={type:"POST",url:udclion.ajaxurl,timeout:1e3*r,headers:{"X-Secondary-User-Agent":"UpdraftCentral-dashboard.js/"+udclion.udc_version},data:n,contentType:!1,processData:!1,dataType:"text",success:function(e){o.children(".updraftcentral_spinner").remove(),a.resolve(e)},error:function(e,t,r){o.children(".updraftcentral_spinner").remove(),a.reject(r)}},jQuery.ajax(n),a.promise()}(t[0].files[0],{phrase:e}).then(function(e){e=JSON.parse(e);e.data.hasOwnProperty("errors")&&e.data.errors.length?UpdraftCentral_Library.dialog.alert("<h2>"+udclion.import_response_heading+"</h2>"+e.data.errors[0]):UpdraftCentral_Library.dialog.alert("<h2>"+udclion.import_response_heading+"</h2>"+udclion.import_successful,function(){UpdraftCentral.close_modal(),location.reload()})}).fail(function(e){UpdraftCentral_Library.dialog.alert("<h2>"+udclion.import_response_heading+"</h2>"+e)}):UpdraftCentral.send_ajax("export_settings",{phrase:e},null,"via_mothership_encrypting","#updraftcentral_dashboard_existingsites",function(e,t,r){"ok"==t&&e.hasOwnProperty("data")&&e.data.hasOwnProperty("json_data")&&(UpdraftCentral.close_modal(),(t=document.body.appendChild(document.createElement("a"))).setAttribute("download",e.data.file_name),t.setAttribute("style","display:none;"),t.setAttribute("href","data:text/json;charset=UTF-8,"+encodeURIComponent(e.data.json_data)),t.click())},null,!1)},udclion.export_settings,null,!1,"exportsettings_dialog",null,null)}),g("#updraftcentral_dashboard_existingsites").on("updraftcentral_dashboard_mode_set_sites",function(e){register_modal_listener("#updraftcentral_addsite_expertoptions_show",function(e){g(this).slideUp(),g("#updraftcentral_modal #updraftcentral_editsite_expertoptions .initially-hidden").show(),e.preventDefault()})}),g("#updraftcentral_notice_container").on("click","a",function(e){w(g(this).attr("href"),e)}),g("#updraftcentral_dashboard_existingsites").on("updraftcentral_dashboard_mode_set",function(e,t){var r=g("#updraft-menu-item-"+t.new_mode).find(".menu-label").html(),a=g(".updraftcentral_mode_actions");0===a.find("h2.screen-title").length&&a.prepend('<h2 class="screen-title"></h2>'),a.find("h2.screen-title").html(r),register_modal_listener("a",function(e){w(g(this).attr("href"),e)}),g("#updraftcentral_dashboard_existingsites_container").on("click",".updraftcentral_site_row a",function(e){w(g(this).attr("href"),e)}),register_modal_listener("#updraft_debug_empty_browser_cache",function(e){for(var t=0,r=0<f,a=localStorage.length;0<=a;--a){var n=localStorage.key(a);null!==n&&"updraftcentral_"==n.substr(0,15)&&(r&&console.log("UpdraftCentral: Removing key from local storage: "+n),localStorage.removeItem(n),t++)}0<t?UpdraftCentral_Library.dialog.alert("<h2>"+udclion.empty+" "+udclion.browser_cache+"</h2>"+sprintf(udclion.cache_emptied,t)):UpdraftCentral_Library.dialog.alert("<h2>"+udclion.empty+" "+udclion.browser_cache+"</h2>"+udclion.cache_no_contents)}),register_modal_listener("#updraft_debug_show_browser_cache",function(e){for(var t=0,r=0,a=localStorage.length;r<a;++r){var n=localStorage.key(r),o=localStorage.getItem(n);"updraftcentral_"==n.substr(0,15)&&(t++,console.log(n+": "+o))}0<t?UpdraftCentral_Library.dialog.alert("<h2>"+udclion.log_contents+"</h2>"+udclion.cache_contents_logged):UpdraftCentral_Library.dialog.alert("<h2>"+udclion.log_contents+"</h2>"+udclion.cache_no_contents)}),t&&t.hasOwnProperty("new_mode")&&"notices"==t.new_mode||(register_modal_listener(".updraftcentral_site_editdescription",function(e){e.preventDefault(),open_site_configuration(UpdraftCentral.$site_row)}),register_modal_listener(".updraftcentral_test_other_connection_methods",function(e){e.preventDefault(),UpdraftCentral_Library.open_connection_test(UpdraftCentral.$site_row)}),register_modal_listener("a.connection-test-switch",function(e){e.preventDefault();var t=g(this).data("connection_method");UpdraftCentral.close_modal();e=g(this).data("site_id");UpdraftCentral.send_ajax("edit_site_connection_method",{site_id:e,connection_method:t},null,"via_mothership_encrypting","#updraftcentral_dashboard_existingsites",function(e,t,r){"ok"==t&&(e.hasOwnProperty("message")&&add_dashboard_notice(e.message),e.hasOwnProperty("sites_html")?(UpdraftCentral.set_existing_sites_to(e.sites_html),_()):(console.log(e),add_dashboard_notice(udclion.unknown_response,"error")),e.hasOwnProperty("status_info")&&b(e.status_info))})}),register_modal_listener(".updraftcentral_siteinfo_results .phpinfo",function(e){e.preventDefault(),UpdraftCentral.send_site_rpc("core.phpinfo",null,UpdraftCentral.$site_row,function(e,t,r){var a;"ok"==t&&e.data&&(a="",g.each(e.data,function(e,t){a+="<h3>"+e+"</h3>\n<table>\n",g.each(t,function(e,t){t.constructor===Array?a+="<tr><td>"+e+"</td><td>"+t[0]+"</td><td>"+t[1]+"</td></tr>\n":"string"==typeof t?g.isNumeric(e)?a+="<tr><td></td><td>"+t+"</td></tr>\n":a+="<tr><td>"+e+"</td><td>"+t+"</td></tr>\n":(console.log("UpdraftCentral: phpinfo: Unrecognised output for key "+e+" (follows)"),console.log(t))}),a+="</table>\n"}),UpdraftCentral.open_modal(udclion.phpinfo,'<div id="updraftcentral_phpinfo_results">'+a+"</div>",null,!1,null,!0,"modal-lg"))},g(this))}),register_modal_listener("#updraftcentral_site_connection_method",function(){var e=g("#updraftcentral_site_connection_method").val();null!=e&&("direct_"==e.substring(0,7)&&"https:"==document.location.protocol?g("#updraftcentral_site_connection_method_message").show().html(udclion.http_must_go_via_mothership):g("#updraftcentral_site_connection_method_message").hide())},"change"),d(".updraftcentral_site_adddescription",function(e){open_site_configuration(e)}),d(".updraftcentral_site_delete",function(t){UpdraftCentral_Library.dialog.confirm("<h2>"+udclion.remove_site+"</h2><p>"+UpdraftCentral_Library.escape_attrib(t.data("site_url"))+"</p><p>"+udclion.really_delete_site+"</p>",function(e){!e||(e=UpdraftCentral.$site_row.data("site_id"))&&(t.slideUp("slow"),UpdraftCentral.send_ajax("delete_site",{site_id:e},null,"via_mothership_encrypting","#updraftcentral_dashboard_existingsites",function(e,t,r){"ok"==t&&(e.hasOwnProperty("message")&&add_dashboard_notice(e.message),e.hasOwnProperty("sites_html")?UpdraftCentral.set_existing_sites_to(e.sites_html):(console.log(e),add_dashboard_notice(udclion.unknown_response,"error")),e.hasOwnProperty("status_info")&&b(e.status_info))}))})}),d(".row_siteinfo",function(e){UpdraftCentral.send_site_rpc("core.site_info",null,e,function(e,t,r){var a,n;1<f&&(console.log("send_site_rpc(site_info): parsed response follows"),console.log(e)),"ok"==t&&!1!==e&&(n=e.data.versions,a=e.data.bloginfo,t=UpdraftCentral_Library.sanitize_html(a.url),UpdraftCentral_Library.sanitize_html(a.name),"none"==(e=n.ud)&&(e=udclion.updraftplus.version_none),n=sprintf(udclion.what_remote_running,n.wp,n.php,n.mysql,e,n.udrpc_php),UpdraftCentral.open_modal(UpdraftCentral_Library.sanitize_html(a.name),UpdraftCentral.template_replace("dashboard-siteinfo",{url:t,message:n,phpinfo:udclion.phpinfo}),null,!1))})}),d(".updraftcentral_site_dashboard",function(e){UpdraftCentral_Library.open_browser_at(e)}))}),this.get_advanced_site_options_html=function(e){return UpdraftCentral.template_replace("sites-advanced-site-options",e)},this.open_site_configuration=function(o){var e=o.data("site_url"),t=o.data("http_username");void 0===t&&(t="");var r=o.data("http_password");void 0===r&&(r="");var a=o.data("connection_method");void 0===a&&(a="direct_default_auth");var n=o.data("http_authentication_method");void 0===n&&(n="basic");var i=o.data("site_description");i==e&&(i="");var s=o.data("send_cors_headers");void 0!==s&&!s||(s=1);r=UpdraftCentral.get_advanced_site_options_html({http_username:t,http_password:r});UpdraftCentral.open_modal(udclion.edit_site_configuration,UpdraftCentral.template_replace("sites-edit-configuration",{site_url:UpdraftCentral_Library.escape_attrib(e),advanced_options:r},{existing_description:i}),function(){var e,t=g("#updraftcentral-edit-site-description").val(),r=g("#updraftcentral_modal #updraftcentral_site_send_cors_headers").is(":checked")?1:0,a=g("#updraftcentral_modal #updraftcentral_site_connection_method").val(),n=o.data("site_id");n&&(UpdraftCentral.close_modal(),e=UpdraftCentral_Library.get_serialized_options("#updraftcentral_modal .expert_option"),UpdraftCentral.send_ajax("edit_site_configuration",{site_id:n,description:t,extra_site_info:e,send_cors_headers:r,connection_method:a},null,"via_mothership_encrypting","#updraftcentral_dashboard_existingsites",function(e,t,r){"ok"==t&&(e.hasOwnProperty("message")&&add_dashboard_notice(e.message),e.hasOwnProperty("sites_html")?(UpdraftCentral.set_existing_sites_to(e.sites_html),_()):(console.log(e),add_dashboard_notice(udclion.unknown_response,"error")),e.hasOwnProperty("status_info")&&b(e.status_info))}))},udclion.edit,function(){g("#updraftcentral_modal #updraftcentral_site_connection_method").val(a).change(),s&&g("#updraftcentral_modal #updraftcentral_site_send_cors_headers").prop("checked",!0),g("#updraftcentral_modal #updraftcentral_addsite_http_authentication_method").val(n)},!1)},this.debugging_send_command=function(e,t,r,a){r=g("#updraftcentral_dashboard_existingsites").find('.updraftcentral_site_row[data-site_url="'+r+'"]').first();r.length<1?console.log("debugging_send_command: no corresponding row found for the specified URL"):UpdraftCentral.send_site_rpc(e,t,r,function(e,t,r){},null,a=void 0!==a?a:30)};function y(e){return!(null!==e&&"string"!=typeof e&&"boolean"!=typeof e&&"number"!=typeof e&&void 0!==e&&!jQuery.isPlainObject(e)&&!Array.isArray(e))}this.is_serializable=function(e,t,r){var a=r=void 0===r?"data":r;if(!y(e))return void 0!==t&&t?{status:!1,data:e,error_path:r,error_field:t,error_type:typeof e[t],error_value:e[t]}:{status:!1};for(t in e){if(r+=r&&r.length?" -> "+t:t,!y(e[t]))return{status:!1,data:e,error_path:r,error_field:t,error_type:typeof e[t],error_value:e[t]};if("object"==typeof e[t]){var n=UpdraftCentral.is_serializable(e[t],t,r);if(n.hasOwnProperty("status")&&!n.status)return{status:!1,data:n.data,error_path:n.error_path,error_field:n.error_field,error_type:typeof n.data[n.error_field],error_value:n.data[n.error_field]};r=a}}return!0},this.send_site_rpc=function(e,t,r,a,n,o,i){var s=UpdraftCentral.is_serializable(t);if(null!==t&&s.hasOwnProperty("status")&&!s.status)return console.log("UpdraftCentral: send_site_rpc("+e+") - the submitted data parameter contains unserializable types (follows)"),s.hasOwnProperty("error_field")&&s.error_field?(console.log("Error path: "+s.error_path),console.log("Error field: "+s.error_field),console.log("Error type: "+s.error_type),console.log("Error value follows:"),console.log(s.error_value)):console.log(t),void a.call(this,{error:udclion.js_exception_occurred},"error",null);o=void 0!==o?o:30,r.data("site_id")||(console.log("UpdraftCentral: sent_site_rpc("+e+") command sent, but site ID could not be identified from the row (follows)"),console.log(r)),i=void 0===i?r.data("connection_method"):i,i=0===e.lastIndexOf("updraftclone.",0)?"via_mothership":i,null==n&&(n=r);try{return UpdraftCentral.send_ajax(e,t,r,i,n,a,o)}catch(e){n&&g(n).children(".updraftcentral_spinner").remove();a=a.call(this,{error:e.toString()},"error",null);void 0!==a&&a||(r=void 0!==r&&r.length?r.data("site_description")+" - ":"",UpdraftCentral_Library.dialog.alert("<h2>"+r+udclion.error+"</h2>"+udclion.js_exception_occurred+"<br>"+e.toString()),console.log(e))}},g("#updraftcentral_dashboard .updraft-central-logo img").dblclick(function(){UpdraftCentral_Library.toggle_fullscreen()}),g("#updraft-central-navigation button.updraft-full-screen").on("click",function(){UpdraftCentral_Library.toggle_fullscreen()}),g("#updraft-central-navigation button.updraftcentral-help").on("click",function(){UpdraftCentral_Library.dialog.alert(UpdraftCentral.template_replace("dashboard-help",{uc_version:udclion.updraftcentral_version+": "+udclion.udc_version,running_on:UpdraftCentral.version_info_as_text()}))}),this.subscribe_to_node_changes=function(e,t,r){var a;void 0===r||!r||n.exists(r)||void 0!==(a=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver)&&a&&((t=new a(t)).observe(g(e).get(0),{attributes:!1,childList:!0,characterData:!1,subtree:!1}),n.add(r,t))},this.unsubscribe_to_node_changes=function(e){void 0!==e&&e&&n.exists(e)&&(n.item(e).disconnect(),n.remove(e))},this.version_info_as_text=function(){return"WP/"+udclion.wp_version+" PHP/"+udclion.php_version+" MySQL/"+udclion.mysql_version+" Curl/"+udclion.curl_version},g("#updraft-central-navigation button.updraftcentral-settings").on("click",function(){u.check_processing_state()||UpdraftCentral.open_modal(udclion.settings,UpdraftCentral.template_replace("dashboard-settings",{uc_version:udclion.updraftcentral_version+": "+udclion.udc_version,running_on:UpdraftCentral.version_info_as_text(),timeout:udclion.user_defined_timeout,shortcut_status:udclion.shortcut_status}),function(){var e=g("#updraftcentral_settings_timeout").val();e.length&&g.isNumeric(e)&&!(e<30)||(e=30),$location=g("#updraftcentral_modal > .uc-settings-container");var r={timeout:e,shortcut_status:g('input[name="uc-shortcuts-activate"]').is(":checked")?"active":"inactive"};UpdraftCentral.save_settings(r,$location).then(function(e){udclion.user_defined_timeout=r.timeout,udclion.shortcut_status=r.shortcut_status;var t=g("#updraftcentral_debug_level").val();0<=t&&t<=3&&UpdraftCentral.set_debug_level(t),UpdraftCentral.close_modal()})},udclion.save_settings,function(){g("#updraftcentral_debug_level").val(f)})}),g(".updraftcentral_row_extracontents").on("click",".dashicons-image-rotate",function(){g(".dashicons-image-rotate").addClass("dashicon-image-rotating")}),this.template_replace=function(e,r,t){return r=void 0===r?{}:r,UpdraftCentral_Handlebars.hasOwnProperty(e)||(console.log("UDCentral: UpdraftCentral_Handlebars template not found: "+e),console.log(UpdraftCentral_Handlebars)),void 0!==t&&g.each(t,function(e,t){r[e]=UpdraftCentral_Library.quote_attribute(t)}),r.udclion=udclion,"object"==typeof UpdraftCentral_Handlebars[e]?UpdraftCentral_Handlebars[e].handlebars(r):UpdraftCentral_Handlebars[e](r)},UpdraftCentral_Handlebars="undefined"==typeof UpdraftCentral_Handlebars?{}:UpdraftCentral_Handlebars,Handlebars.registerHelper("uc_each",function(e,t){var r="";if(void 0===e)return r;for(var a=0,n=e.length;a<n;a++){var o=e[a];o.hasOwnProperty("as_json")||(o.as_json=JSON.stringify(o)),o.hasOwnProperty("udclion")||(o.udclion=udclion),r+=t.fn(o)}return r}),udclion.hasOwnProperty("handlebars")&&udclion.handlebars.hasOwnProperty("compile")&&g.each(udclion.handlebars.compile,function(e,t){console.log("UpdraftCentral: in developer mode: compile template: "+e),UpdraftCentral_Handlebars[e]=Handlebars.compile(t)}),_();var a=setInterval(function(){"undefined"!==u.uc_module&&(clearInterval(a),set_dashboard_mode("sites"),!1!==u.uc_module&&g("#updraftcentral_dashboard_existingsites").trigger("updraftcentral_sites_loaded",{module:u.uc_module}))},100);"undefined"==typeof Modernizr||Modernizr.lastchild?(g("#updraftcentral_dashboard_loading").fadeOut(),g("#updraftcentral_dashboard_existingsites_container").fadeIn(),udclion.hasOwnProperty("show_licence_counts")&&udclion.show_licence_counts&&g(".updraftcentral_licence_info").show(),setInterval(function(){UpdraftCentral.send_ajax("sites_html",null,null,"via_mothership_encrypting","#updraftcentral_dashboard_existingsites",function(e,t,r){"ok"==t&&(e.hasOwnProperty("sites_html")?UpdraftCentral.set_existing_sites_to(e.sites_html):(console.log("Expected sites_html data not found:"),console.log(e)),e.hasOwnProperty("status_info")&&b(e.status_info))})},864e5)):(console.log("UDCentral: Unsupported web browser"),g("#updraftcentral_dashboard_loading").fadeOut(),g("#updraftcentral_updraftplus_actions, #updraftcentral_sites_actions, #updraftcentral_dashboard_existingsites_container").remove(),this.add_dashboard_notice(udclion.unsupported_browser,"error",!1)),g("#updraftcentral_notice_container .updraftcentral_notice.remove_after_load").delay(3e4).slideUp("slow",function(){g(this).remove()}),g("#updraftcentral_modal_dialog").appendTo(document.body),this.storage_set=function(t,r,e){void 0!==e&&e&&(a=Math.floor(Date.now()/1e3),localStorage.setItem("updraftcentral_saved_at_"+t,a)),1<f&&console.log("UpdraftCentral.storage_set(key="+t+")");try{localStorage.setItem("updraftcentral_"+t,JSON.stringify(r))}catch(e){console.log(e);var a=this.storage_purge();0<a&&(1<f&&console.log("UpdraftCentral.storage_set(key="+t+") failed; but purged "+a+" items, so trying again"),localStorage.setItem("updraftcentral_"+t,JSON.stringify(r)))}},this.storage_get=function(e,t){if(void 0!==t&&0<t){var r=localStorage.getItem("updraftcentral_saved_at_"+e);if(!r)return null;var a=Math.floor(Date.now()/1e3),n=a-r;if(1<UpdraftCentral.updraftcentral_debug_level&&console.log("UpdraftCentral.storage_get(key="+e+", maximum_age="+t+"): stored_at="+r+", epoch_time="+a+", stored_ago="+n),t<n)return null}e=localStorage.getItem("updraftcentral_"+e);if(void 0===e)return null;try{return JSON.parse(e)}catch(e){}return null},this.storage_purge=function(){var e=0;for(i=localStorage.length-1;0<=i;i--){var t,r=localStorage.key(i);null!==r&&(t=(new Date).getTime()/1e3,"updraftcentral_saved_at_wporg_api_"!=r.substring(0,34)||600<(t=t-localStorage.getItem(r))&&(0<f&&console.log("UpdraftCentral::storage_purge(): purging key: "+r.substring(24)+" (age: "+t+" s)"),this.storage_remove(r.substring(24)),e++))}return e},this.storage_remove=function(e){localStorage.removeItem("updraftcentral_saved_at_"+e),localStorage.removeItem("updraftcentral_"+e)},this.init_recorder=function(){u.recorder=new UpdraftCentral_Recorder,recorder.load()},this.init_keyboard_shortcuts=function(){(new UpdraftCentral_Keyboard_Shortcuts).init()};var C=g("#visible-modules-container .updraft-menu-item-container"),U=g("#hidden-modules-container"),e=g(".module-visibility"),x=[],k=[],O="",P=g('<div class="updraft-menu-item-container"><button id="updraft-menu-item-all" class="updraft-menu-item">'+udclion.show_all+"</button></div>"),j=g("#hidden-modules-menu");j.hide();var S=g(".uc-hidden-modules-menu"),L=g(".uc-hidden-modules-close");function D(){0<g(this).find(".dashicons-visibility").length?(O=(O=g(this).children(".updraft-menu-item").prop("id")).replace("updraft-menu-item-",""),k.push(O),g(this).hide()):(O=(O=g(this).children(".updraft-menu-item").prop("id")).replace("updraft-menu-item-",""),x.push(O))}return L.hide(),C.each(D),0===k.length?U.hide():1<k.length&&P.appendTo(U.next()),U.find(".uc-hidden-modules-label").text(udclion.hidden_modules+"("+k.length+")"),e.hover(function(){g(this).parent().find(".updraft-menu-item-links").addClass("updraft-menu-item-hover")},function(){g(this).parent().find(".updraft-menu-item-links").removeClass("updraft-menu-item-hover")}),g("#updraft-central-navigation-sidebar").on("click",e,function(e){var a,n;(g(e.target).parent().hasClass("module-visibility")||g(e.target).hasClass("module-visibility"))&&(a=g(e.target).closest(".module-visibility"),O=(O=a.prev().attr("id")).replace("updraft-menu-item-",""),n=!1,0<a.find(".dashicons-visibility").length?(k=g.grep(k,function(e){return e!=O}),x.push(O),n=!0):(a.html('<span class="dashicons dashicons-visibility"></span>'),x=g.grep(x,function(e){return e!=O}),k.push(O)),UpdraftCentral.send_ajax("module_visibility",{module_id:O,visibility:n},null,"via_mothership_encrypting",null,function(e,t,r){"ok"===t&&(!1===n?(a.parent().clone().appendTo(j),a.prev().removeClass("updraft-menu-item-hover").parent().slideUp(),j.find(".updraft-menu-item-links").removeClass("updraft-menu-item-hover").removeClass("updraft-menu-item-links-active"),0<j.find(".updraft-menu-item-container").length&&(U.slideDown(),1<j.find(".updraft-menu-item-container").length&&P.appendTo(U.next()))):(a.parent().remove(),g(".updraft-menu-item-container").find(".updraft-menu-item-"+O).next().html('<span class="dashicons dashicons-hidden"></span>').parent().slideDown(),0===j.find(".updraft-menu-item-container").length?U.slideUp():j.find(".updraft-menu-item-container").length<2&&P.remove()),U.find(".uc-hidden-modules-label").text(udclion.hidden_modules+"("+k.length+")"))}))}),g("#updraft-central-navigation-sidebar").on("click","#updraft-menu-item-all",function(){UpdraftCentral.send_ajax("reset_modules_visibility","all",null,"via_mothership_encrypting",null,function(e,t,r){"ok"===t&&(C.each(D),C.each(function(){g(this).find(".updraft-menu-item").removeClass("updraft-menu-item-hover"),g(this).slideDown(),g(".module-visibility",this).html('<span class="dashicons dashicons-hidden"></span>')}),U.slideUp("normal",function(){L.hide(),S.show(),j.hide(),j.find(".updraft-menu-item-container").remove()}),k.length=0)})}),S.click(function(){j.slideToggle("normal",function(){L.show(),S.hide()})}),L.click(function(){j.slideToggle("normal",function(){L.hide(),S.show()})}),this};